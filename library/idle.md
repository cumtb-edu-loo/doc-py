# IDLE¶

**源代码：** [Lib/idlelib/](https://github.com/python/cpython/tree/3.12/Lib/idlelib/)

* * *

IDLE 是 Python 所内置的开发与学习环境。

IDLE 具有以下特性：

  * 编码于 100% 纯正的 Python，使用名为 [`tkinter`](tkinter.md#module-tkinter "tkinter: Interface to Tcl/Tk for graphical user interfaces") 的图形用户界面工具

  * 跨平台：在 Windows、Unix 和 macOS 上工作近似。

  * 提供输入输出高亮和错误信息的 Python 命令行窗口 （交互解释器）

  * 提供多次撤销操作、Python 语法高亮、智能缩进、函数调用提示、自动补全等功能的多窗口文本编辑器

  * 在多个窗口中检索，在编辑器中替换文本，以及在多个文件中检索（通过 grep）

  * 提供持久保存的断点调试、单步调试、查看本地和全局命名空间功能的调试器

  * 配置、浏览以及其它对话框

## 目录¶

IDEL 有两种主要的窗口类型：Shell窗口和编辑器窗口。其中编辑器窗口可以同时打开多个。并且对于 Windows 和 Linux 平台，窗口顶部主菜单各不相同。以下每个菜单说明项，都标识了与之关联的平台类型。

导出窗口，例如使用 编辑=>在文件中查找 是编辑器窗口的的一个子类型。它们目前有着相同的主菜单，但是默认标题和上下文菜单不同。

在macOS上，只有一个应用程序菜单。它会根据当前选择的窗口动态变化。它具有一个IDLE菜单，并且下面描述的某些条目已移动到符合Apple准则的位置。

### 文件菜单 （命令行和编辑器）¶

新建文件

    

~~~
创建一个文件编辑器窗口。

打开...
~~~
    

~~~
使用打开窗口以打开一个已存在的文件。

打开模块...
~~~
    

~~~
打开一个已存在的模块 （搜索 sys.path）

近期文件
~~~
    

~~~
打开一个近期文件列表，选取一个以打开它。

模块浏览器
~~~
    

~~~
于当前所编辑的文件中使用树形结构展示函数、类以及方法。在命令行中，首先打开一个模块。

路径浏览
~~~
    

~~~
在树状结构中展示 sys.path 目录、模块、函数、类和方法。

保存
~~~
    

~~~
如果文件已经存在，则将当前窗口保存至对应的文件。自打开或上次保存之后经过修改的文件的窗口标题栏首尾将出现星号 * 。如果没有对应的文件，则使用“另存为”代替。

保存为...
~~~
    

~~~
通过 Save As 对话框保存当前窗口。 被保存的文件将成为关联到该窗口的新文件。 （如果你的文件管理器被设为隐藏扩展名，则当前扩展名将在文件名文本框中被省略。 如果新的文件名不带 '.'，则将为 Python 和文本文件添加 '.py' 和 '.txt'，除非是在 macOS Aqua, 上，这时将为所有文件添加 '.py'。）

另存为副本...
~~~
    

~~~
将当前窗口保存到不同的文件而不改变已关联的文件。 （请参阅上文 Save As 中有关文件扩展名的说明。）

打印窗口
~~~
    

~~~
通过默认打印机打印当前窗口。

关闭窗口
~~~
    

~~~
关闭当前窗口（如果是未保存的编辑器窗口，则会提示保存；如果是未保存的 Shell 窗口，则会提示退出执行）。 在Shell 窗口中调用 `exit()` 或 `close()` 也会关闭 Shell 窗口。 如果这是唯一的窗口，则还会退出 IDLE。

退出 IDLE
~~~
    

~~~
关闭所有窗口并退出 IDLE (将提示保存未保存的编辑窗口）。

### 编辑菜单（命令行和编辑器）¶

撤销操作
~~~
    

~~~
撤销当前窗口的最近一次操作。最高可以撤回 1000 条操作记录。

重做
~~~
    

~~~
重做当前窗口最近一次所撤销的操作。

全选
~~~
    

~~~
选择当前窗口的全部内容。

剪切
~~~
    

~~~
复制选区至系统剪贴板，然后删除选区。

复制
~~~
    

~~~
复制选区至系统剪贴板。

粘贴
~~~
    

~~~
插入系统剪贴板的内容至当前窗口。

剪贴板功能也可用于上下文目录。

查找...
~~~
    

~~~
打开一个提供多选项的查找窗口。

再次查找
~~~
    

~~~
重复上一次搜索（如果有的话）。

查找选区
~~~
    

~~~
查找当前选中的字符串，如果存在

在文件中查找...
~~~
    

~~~
打开文件查找对话框。将结果输出至新的输出窗口。

替换...
~~~
    

~~~
打开 查找并替换 对话框。

前往行
~~~
    

~~~
将光标移到所请求行的开头并使该行可见。 对于超过文件尾的请求将会移到文件尾。 清除所有选区并更新行列状态。

显示补全信息
~~~
    

~~~
打开一个可滚动列表以允许选择现有的名称。 请参阅下面编辑与导航一节中的 自动补全。

展开文本
~~~
    

~~~
展开键入的前缀以匹配同一窗口中的完整单词；重复以获得不同的扩展。

显示调用提示
~~~
    

~~~
在函数的右括号后，打开一个带有函数参数提示的小窗口。 请参阅下面的“编辑和导航”部分中的 调用提示。

显示周围括号
~~~
    

~~~
突出显示周围的括号。

### 格式菜单（仅 window 编辑器）¶

格式段落
~~~
    

~~~
在注释块或多行字符串或字符串中的选定行中，重新格式化当前以空行分隔的段落。段落中的所有行的格式都将少于N列，其中N默认为72。

增加缩进
~~~
    

~~~
将选定的行右缩进（默认为4个空格）。

减少缩进
~~~
    

~~~
将选定的行左缩进（默认为4个空格）。

注释
~~~
    

~~~
在所选行的前面插入 ##。

取消注释
~~~
    

~~~
从所选行中删除开头的 ＃ 或 ##。

制表符化
~~~
    

~~~
将 _前导_ 空格变成制表符。 （注意：我们建议使用4个空格来缩进Python代码。）

取消制表符化
~~~
    

~~~
将 _所有_ 制表符转换为正确的空格数。

缩进方式切换
~~~
    

~~~
打开一个对话框，以在制表符和空格之间切换。

缩进宽度调整
~~~
    

~~~
打开一个对话框以更改缩进宽度。 Python社区接受的默认值为4个空格。

去除尾随空格
~~~
    

~~~
通过将 str.rstrip 应用于每行（包括多行字符串中的行），删除行尾非空白字符之后的尾随空格和其他空白字符。除Shell窗口外，在文件末尾删除多余的换行符。

### 运行菜单（仅 window 编辑器）¶

运行模块
~~~
    

~~~
执行 检查模块 。如果没有错误，重新启动 shell 以清理环境，然后执行模块。输出显示在 shell 窗口中。请注意，输出需要使用 “打印” 或 “写入”。执行完成后，Shell 将保留焦点并显示提示。此时，可以交互地探索执行的结果。这类似于在命令行执行带有 `python -i file` 的文件。

运行... 定制
~~~
    

~~~
与 运行模块 相同，但使用自定义设置运行该模块。 _命令行参数_ 扩展 [`sys.argv`](sys.md#sys.argv "sys.argv") ，就像在命令行上传递一样。该模块可以在命令行管理程序中运行，而无需重新启动。

检查模块
~~~
    

~~~
检查 “编辑器” 窗口中当前打开的模块的语法。如果尚未保存该模块，则 IDLE会提示用户保存或自动保存，如在 “空闲设置” 对话框的 “常规” 选项卡中所选择的那样。如果存在语法错误，则会在 “编辑器” 窗口中指示大概位置。

Python Shell
~~~
    

~~~
打开或唤醒Python Shell窗口。

### Shell 菜单（仅限 Shell 窗口）¶

查看最近重启
~~~
    

~~~
将Shell窗口滚动到上一次Shell重启。

重启Shell
~~~
    

~~~
重启 shell 以清理环境，重置显示和异常处理。

上一条历史记录
~~~
    

~~~
循环浏览历史记录中与当前条目匹配的早期命令。

下一条历史记录
~~~
    

~~~
循环浏览历史记录中与当前条目匹配的后续命令。

中断执行
~~~
    

~~~
停止正在运行的程序。

### 调试菜单（仅限 Shell 窗口）¶

跳转到文件/行
~~~
    

~~~
查看当前行。 以光标提示，且上一行为文件名和行号。 如果找到目标，如果文件尚未打开则打开该文件，并显示目标行。 使用此菜单项来查看异常回溯中引用的源代码行以及用文件中查找功能找到的行。 也可在 Shell 窗口和 Output 窗口的上下文菜单中使用。

调试器（切换）
~~~
    

~~~
激活后，在Shell中输入的代码或从编辑器中运行的代码将在调试器下运行。在编辑器中，可以使用上下文菜单设置断点。此功能不完整，具有实验性。

堆栈查看器
~~~
    

~~~
在树状目录中显示最后一个异常的堆栈回溯，可以访问本地和全局。

自动打开堆栈查看器
~~~
    

~~~
在未处理的异常上切换自动打开堆栈查看器。

### 选项菜单（命令行和编辑器）¶

配置 IDLE
~~~
    

~~~
打开配置对话框并更改以下各项的首选项：字体、缩进、键绑定、文本颜色主题、启动窗口和大小、其他帮助源和扩展名。在MacOS上，通过在应用程序菜单中选择首选项来打开配置对话框。有关详细信息，请参阅：帮助和首选项下的 首选项设置。

大多数配置选项适用于所有窗口或将来的所有窗口。以下选项仅适用于活动窗口。

显示/隐藏代码上下文（仅限编辑器窗口）
~~~
    

~~~
在编辑窗口顶部打开一个面板来显示在窗口顶部滚动的代码块上下文。 请参阅下文“编辑与导航”章节中的 代码上下文。

显示/隐藏行号（仅限 Editor 窗口）
~~~
    

~~~
在编辑窗口左侧打开一个显示代码文本行编号的列。 默认为关闭显示，这可以在首选项中修改 (参见 设置首选项)。

缩放/还原高度
~~~
    

~~~
在窗口的正常尺寸和最大高度之间进行切换。 初始尺寸默认为 40 行每行 80 字符，除非在配置 IDLE 对话框的通用选项卡中做了修改。 屏幕的最大高度由首次在屏幕上将缩小的窗口最大化的操作来确定。 改变屏幕设置可能使保存的高度失效。 此切换操作在窗口最大化状态下无效。

### Window 菜单（命令行和编辑器）¶

列出所有打开的窗口的名称；选择一个将其带到前台（必要时对其进行去符号化）。

### 帮助菜单（命令行和编辑器）¶

关于 IDLE
~~~
    

~~~
显示版本，版权，许可证，荣誉等。

IDLE 帮助
~~~
    

~~~
显示此 IDLE 文档，详细介绍菜单选项，基本编辑和导航以及其他技巧。

Python 文档
~~~
    

~~~
访问本地Python文档（如果已安装），或启动Web浏览器并打开docs.python.org显示最新的Python文档。

海龟演示
~~~
    

~~~
使用示例 Python 代码运行 turtledemo 模块和海龟绘图

可以在 “常规” 选项卡下的 “配置IDLE” 对话框中添加其他帮助源。有关“帮助”菜单选项的更多信息，请参见下面的 帮助源 小节。

### 上下文菜单¶

通过在窗口中右击（在 macOS 上则为按住 Control 键点击）来打开一个上下文菜单。 上下文菜单也具有编辑菜单中的标准剪贴板功能。

剪切
~~~
    

~~~
复制选区至系统剪贴板，然后删除选区。

复制
~~~
    

~~~
复制选区至系统剪贴板。

粘贴
~~~
    

~~~
插入系统剪贴板的内容至当前窗口。

编辑器窗口也具有断点功能。 设置了断点的行会被特别标记。 断点仅在启用调试器运行时有效。 文件的断点会被保存在用户的 `.idlerc` 目录中。

设置断点
~~~
    

~~~
在当前行设置断点

清除断点
~~~
    

~~~
清除当前行断点

shell 和输出窗口还具有以下内容。

跳转到文件/行
~~~
    

~~~
与调试菜单相同。

Shell 窗口也有一个输出折叠功能，参见下文的 _Python Shell 窗口_ 小节。

压缩
~~~
    

~~~
如果将光标位于输出行上，则会折叠在上方代码和下方提示直到 'Squeezed text' 标签之间的所有输出。

## 编辑和导航¶

### 编辑窗口¶

IDLE 可以在启动时打开编辑器窗口，这取决于选项设置和你启动 IDLE 的方式。 在此之后，请使用 File 菜单。 对于给定的文件只能打开一个编辑器窗口。

标题栏包含文件名称、完整路径，以及运行该窗口的 Python 和 IDLE 版本。 状态栏包含行号 ('Ln') 和列号 ('Col')。 行号从 1 开始；列号则从 0 开始。

IDE 会定扩展名为 .py* 的文件包含 Python 代码而其他文件不包含。 可使用 Run 菜单来运行 Python 代码。

### 按键绑定¶

在本节中，'C' 是指 Windows 和 Unix 上的 `Control` 键，以及 macOS 上的 `Command` 键。

  * `Backspace` 向左删除; `Del` 向右删除

  * ``C`-`Backspace`` 向左删除单词; ``C`-`Del`` 向右删除单词

  * 方向键和 `Page Up`/`Page Down` 移动

  * ``C`-`LeftArrow`` 和 ``C`-`RightArrow`` 按单词移动

  * `Home`/`End` 跳转到行首/尾

  * ``C`-`Home``/``C`-`End`` 跳转到文档首/尾

  * 一些有用的Emacs绑定是从Tcl / Tk继承的：

>     * ``C`-`a`` 行首
>
>     * ``C`-`e`` 行尾
>
>     * ``C`-`k`` 删除行（但未将其放入剪贴板）
>
>     * ``C`-`l`` 将插入点设为窗口中心
>
>     * ``C`-`b`` 后退一个字符而不删除该字符（通常你也可以用方向键进行此操作）
>
>     * ``C`-`f`` 前进一个字符而不删除该字符（通常你也可以用方向键进行此操作）
>
>     * ``C`-`p`` 向上一行（通常你也可以用方向键进行此操作）
>
>     * ``C`-`d`` 删除下一个字符

标准的键绑定（例如 ``C`-`c`` 复制和 ``C`-`v`` 粘贴）仍会有效。 键绑定可在配置 IDLE 对话框中选择。

### 自动缩进¶

在一个代码块开头的语句之后，下一行会缩进 4 个空格符（在 Python Shell 窗口中是一个制表符）。 在特定关键字之后（break, return 等），下一行将不再缩进。 在开头的缩进中，按 `Backspace` 将会删除 4 个空格符。 `Tab` 则会插入空格符（在 Python Shell 窗口中是一个制表符），具体数量取决于缩进宽度。 目前，Tab 键按照 Tcl/Tk 的规定设置为四个空格符。

另请参阅 Format 菜单 的缩进/取消缩进区的命令。

### 搜索和替换¶

任何选择都将成为搜索目标。 但是，只有在同一行内的选择才有效因为搜索只针对行进行并会移除换行符。 如果勾选了 `[x] Regular expression`，目标将按照 Python re 模块的规则来解读。

### 补全¶

当被请求并且可用时，将为模块名、类属性、函数或文件名提供补全。 每次请求方法将显示包含现有名称的补全提示框。 （例外情况参见下文的 Tab 补全。） 对于任意提示框，要改变被补全的名称和提示框中被高亮的条目，可以通过输入和删除字符、按 `Up`, `Down`, `PageUp`, `PageDown`, `Home` 和 `End` 键；或是在提示框中单击。 要关闭补全提示框可以通过 `Escape`, `Enter` 或按两次 `Tab` 键或是在提示框外单击。 在提示框内双击则将执行选择并关闭。

有一种打开提示框的方式是输入一个关键字符并等待预设的一段间隔。 此间隔默认为 2 秒；这可以在设置对话框中定制。 （要防止自动弹出，可将时延设为一个很大的豪秒数值，例如 100000000。） 对于导入的模块名或者类和函数属性，请输入 '.'。 对于根目录下的文件名，请在开头引号之后立即输入 [`os.sep`](os.md#os.sep "os.sep") 或 [`os.altsep`](os.md#os.altsep "os.altsep")。 （在 Windows 下，可以先指定一个驱动器。） 可通过输入目录名和分隔符来进入子目录。

除了等待，或是在提示框关闭之后，可以使用 Edit 菜单的 Show Completions 来立即打开一个补全提示框。 默认的热键是 ``C`-`space``。 如果在打开提示框之前输入一某个名称的前缀，则将显示第一个匹配项或最接近的项。 结果将与在提示框已显示之后输入前缀时相同。 在一个引号之后执行 Show Completions 将会实例当前目录下的文件名而不是根目录下的。

在输入前缀后按 `Tab` 键的效果通常与 Show Completions 相同。 （如果未输入前缀则为缩进。） 但是，如果输入的前缀只有一个匹配项，则该匹配项会立即被添加到编辑器文本中而不打开补全提示框。

在字符串以外且开头不带 '.' 地输入前缀并执行 'Show Completions' 或按 `Tab` 键将打开一个包含关键字、内置名称和现有模块级名称的补全提示框。

当在编辑器（而非 Shell）中编辑代码时，可以通过运行你的代码并在此后不重启 Shell 来增加可用的模块级名称。 这在文件顶部添加了导入语句之后会特别有用。 这还会增加可用的属性补全。

补全提示框在初始时会排除以 '_' 打头的名称，对于模块还会排除未包括在 '__all__' 中的名称。 这些隐藏名称可通过在 '.' 之后输入 '_' 来访问，这在提示框打开之前或之后都是有效的。

### 提示¶

当在一个 _可用的_ 函数名称之后输入 `(` 时将自动显示一个调用提示。 函数名称表达式可以包括点号和方括号索引操作。 调用提示将保持打开直到它被点击、光标移出参数区、或是输入了 `)`。 当光标位于某个定义的参数区时，可以在菜单中选择 Edit 的 "Show Call Tip" 或是输入其快捷键来显示调用提示。

调用提示是由函数的签名和文档字符串到第一个空行或第五个非空行为止的内容组成的。 （某些内置函数没有可访问的签名。） 签名中的 '/' 或 '*' 指明其前面或后面的参数仅限以位置或名称（关键字）方式传入。 具体细节可能会改变。

在 Shell 中，可访问的函数取决于有哪些模块已被导入用户进程，包括由 IDLE 本身导入的模块，以及哪些定义已被运行，以上均从最近的重启动开始算起。

例如，重启动 Shell 并输入 `itertools.count(`。 将显示调用提示，因为 IDLE 出于自身需要已将 itertools 导入了用户进程。 （此行为可能会改变。） 输入 `turtle.write(` 则不显示任何提示。 因为 IDLE 本身不会导入 turtle。 菜单项和快捷键同样不会有任何反应。 输入 `import turtle`。 则在此之后，`turtle.write(` 将显示调用提示。

在编辑器中，import 语句在文件运行之前是没有效果的。 在输入 import 语句之后、添加函数定义之后，或是打开一个现有文件之后可以先运行一下文件。

### 代码上下文¶

在一个包含 Python 代码的编辑器窗口内部，可以切换代码上下文以便显示或隐藏窗口顶部的面板。 当显示时，此面板可以冻结代码块的开头行，例如以 `class`, `def` 或 `if` 关键字开头的行，这样的行在不显示时面板时可能离开视野。 此面板的大小将根据需要扩展和收缩以显示当前层级的全部上下文，直至达到配置 IDLE 对话框中所定义的最大行数（默认为 15）。 如果如果没有当前上下文行而此功能被启用，则将显示一个空行。 点击上下文面板中的某一行将把该行移至编辑器顶部。

上下文面板的文本和背景颜色可在配置 IDLE 对话框的 Highlights 选项卡中进行配置。

### Shell 窗口¶

在 IDLE 的 Shell 中，输入、编辑和重新执行完整的语句。 （多数控制台和终端每次只能操作一个物理行）。

在光标位于行内任意位置的情况下按 `Return` 键来将单行语句提交执行。 如果带有强制换行的反斜杠 (`\`)，则光标必须位于最后一个物理行。 对于包含多行的复合语句要通过在语句之后额外输入一个空行来提交执行。

当将代码粘贴到 Shell 中时，它并不会被编译并执行除非如上所述地再按下 `Return` 键。 可以先对粘贴的代码进行编辑。 如果将多条语句粘贴到 Shell 中，则多条语句被当作一条语句来编译并引发 [`SyntaxError`](exceptions.md#SyntaxError "SyntaxError")。

包含 `RESTART` 的行表明用户执行进程已被重启。 这种情况会在用户执行进程崩溃、在 Shell 菜单中选择重启，或在编辑器窗口中运行代码时发生。

之前小节中描述的编辑功能在交互式地输入代码时也可使用。 IDLE 的 Shell 窗口还会响应以下按键。

  * ``C`-`c`` 中断执行命令

  * ``C`-`d`` 发送文件结束命令；如果在 `>>>` 提示符后按下会关闭窗口。

  * ``Alt`-`/`` (扩展单词) 也有助于减少按键量

历史命令

    * ``Alt`-`p`` 提取与你所输入键匹配的前一条命令。 在 macOS 上请使用 ``C`-`p``。

    * ``Alt`-`n`` 提取下一条命令。 在 macOS 上请使用 ``C`-`n``。

    * 当光标位于之前的任意命令上时按 `Return` 键将提取该命令。

### 文本颜色¶

IDLE 文本默认为白底黑字，但有特殊含义的文本将以彩色显示。 对于 Shell 来说包括 Shell 输出，Shell 错误，用户输出和用户错误。 对于 Shell 提示符下或编辑器中的 Python 代码来说则包括关键字，内置类和函数名称，`class` 和 `def` 之后的名称，字符串和注释等。 对于任意文本窗口来说则包括光标（如果存在）、找到的文本（如果可能）和选定的文本。

IDLE 还会高亮显示模式匹配语句中的 [软关键字](../reference/lexical_analysis.md#soft-keywords) [`match`](../reference/compound_stmts.md#match), [`case`](../reference/compound_stmts.md#match) 和 [`_`](../reference/compound_stmts.md#wildcard-patterns)。 但是，这种高亮显示并不完美，在某些极端情况下还会出现错误，包括 `_` 在 `case` 模式中出现的时候。

广西着色是在背景上完成的，因此有时会看到非着色的文本。 要改变颜色方案，请使用配置 IDLE 对话框的高亮选项卡。 编辑器中的调试器断点行标记和弹出面板和对话框中的文本则是用户不可配置的。

## 启动和代码执行¶

在附带 `-s` 选项启用的情况下，IDLE 将会执行环境变量 `IDLESTARTUP` 或 [`PYTHONSTARTUP`](../using/cmdline.md#envvar-PYTHONSTARTUP) 所引用的文件。 IDLE 会先检查 `IDLESTARTUP`；如果 `IDLESTARTUP` 存在则会运行被引用的文件。 如果 `IDLESTARTUP` 不存在，则 IDLE 会检查 `PYTHONSTARTUP`。 这些环境变量所引用的文件是存放经常被 IDLE Shell 所使用的函数，或者执行导入常用模块的 import 语句的便捷场所。

此外，`Tk` 也会在存在启动文件时加载它。 请注意 Tk 文件会被无条件地加载。 此附加文件名为 `.Idle.py` 并且会在用户的家目录下查找。 此文件中的语句将在 Tk 的命名空间中执行，所以此文件不适用于导入要在 IDLE 的 Python Shell 中使用的函数。

### 命令行用法¶
~~~
    
    
~~~
idle.py [-c command] [-d] [-e] [-h] [-i] [-r file] [-s] [-t title] [-] [arg] ...

-c command  run command in the shell window
-d          enable debugger and open shell window
-e          open editor window
-h          print help message with legal combinations and exit
-i          open shell window
-r file     run file in shell window
-s          run $IDLESTARTUP or $PYTHONSTARTUP first, in shell window
-t title    set title of shell window
-           run stdin in shell (- must be last option before args)
~~~

如果有参数：

  * 如果使用了 `-`, `-c` 或 `r`，则放在 `sys.argv[1:...]` 和 `sys.argv[0]` 中的所有参数都会被设为 `''`, `'-c'` 或 `'-r'`。 不会打开任何编辑器窗口，即使是在选项对话框中的默认设置。

  * 在其他情况下，参数为要打开编辑的文件而 `sys.argv` 反映的是传给 IDLE 本身的参数。

### 启动失败¶

IDLE 使用一个套接字在 IDLE GUI 进程和用户代码执行进程之间通信。 当 Shell 启动或重启动时必须建立一个连接。 （重启动会以一个内容为 'RESTART' 的分隔行来标示）。 如果用户进程无法连接到 GUI 进程，它通常会显示一个包含 'cannot connect' 消息的 `Tk` 错误提示框来引导用户。 随后将会退出程序。

有一个 Unix 系统专属的连接失败是由系统网络设置中错误配置的掩码规则导致的。 当从一个终端启动 IDLE 时，用户将看到一条以 `** Invalid host:` 开头的消息。 有效的值为 `127.0.0.1 (idlelib.rpc.LOCALHOST)`。 用户可以在一个终端窗口输入 `tcpconnect -irv 127.0.0.1 6543` 并在另一个终端窗口中输入 `tcplisten <same args>` 来进行诊断。

导致连接失败的一个常见原因是用户创建的文件与标准库模块同名，例如 _random.py_ 和 _tkinter.py_ 。 当这样的文件与要运行的文件位于同一目录中时，IDLE 将无法导入标准库模块。 可用的解决办法是重命名用户文件。

虽然现在已不太常见，但杀毒软件或防火墙程序也有可能会阻止连接。 如果无法将此类程序设为允许连接，那么为了运行 IDLE 就必须将其关闭。 允许这样的内部连接是安全的，因为数据在外部端口上不可见。 一个类似的问题是错误的网络配置阻止了连接。

Python 的安装问题有时会使 IDLE 退出：存在多个版本时可能导致程序崩溃，或者单独安装时可能需要管理员权限。 如果想要避免程序崩溃，或是不想以管理员身份运行，最简单的做法是完全卸载 Python 并重新安装。

有时会出现 pythonw.exe 僵尸进程问题。 在 Windows 上，可以使用任务管理员来检查并停止该进程。 有时由程序崩溃或键盘中断（control-C）所发起的重启动可能会出现连接失败。 关闭错误提示框或使用 Shell 菜单中的 Restart Shell 可能会修复此类临时性错误。

当 IDLE 首次启动时，它会尝试读取 `~/.idlerc/` 中的用户配置文件（~ 是用户的家目录）。 如果配置有问题，则应当显示一条错误消息。 除随机磁盘错误之外，此类错误均可通过不手动编辑这些文件来避免。 请使用 Options 菜单来打开配置对话框。 一旦用户配置文件出现错误，最好的解决办法就是删除它并使用配置对话框重新设置。

如果 IDLE 退出时没有发出任何错误消息，并且它不是通过控制台启动的，请尝试通过控制台或终端 (`python -m idlelib`) 来启动它以查看是否会出现错误消息。

在基于 Unix 的系统上使用 tcl/tk 低于 `8.6.11` 的版本 (查看 `About IDLE`) 时特定字体的特定字符可能导致终端提示 tk 错误消息。 这可能发生在启动 IDLE 编辑包此种字符的文件或是在之后输入此种字符的时候。 如果无法升级 tcl/tk，可以重新配置 IDLE 来使用其他的字体。

### 运行用户代码¶

除了少量例外，使用 IDLE 执行 Python 代码的结果应当与使用默认方法，即在文本模式的系统控制台或终端窗口中直接通过 Python 解释器执行同样的代码相同。 但是，不同的界面和操作有时会影响显示的结果。 例如，`sys.modules` 初始时具有更多条目，而 `threading.active_count()` 将返回 2 而不是 1。

在默认情况下，IDLE 会在单独的 OS 进程中运行用户代码而不是在运行 Shell 和编辑器的用户界面进程中运行。 在执行进程中，它会将 `sys.stdin`, `sys.stdout` 和 `sys.stderr` 替换为从 Shell 窗口获取输入并向其发送输出的对象。 保存在 `sys.__stdin__`, `sys.__stdout__` 和 `sys.__stderr__` 中的原始值不会被改变，但可能会为 `None`。

将打印输出从一个进程发送到另一个进程中的文本部件要比打印到同一个进程中的系统终端慢。 这在打印多个参数时将有更明显的影响，因为每个参数、每个分隔符和换行符对应的字符串都要单独发送。 在开发中，这通常不算是问题，但如果希望能在 IDLE 中更快地打印，可以将想要显示的所有内容先格式化并拼接到一起然后打印单个字符串。 格式字符串和 [`str.join()`](stdtypes.md#str.join "str.join") 都可以被用于合并字段和文本行。

IDLE 的标准流替换不会被执行进程中创建的子进程所继承，不论它是由用户代码直接创建还是由 multiprocessing 之类的模块创建的。 如果这样的子进程使用了 `input` 从 sys.stdin 输入或者使用了 `print` 或 `write` 向 sys.stdout 或 sys.stderr 输出，则应当在命令行窗口中启动 IDLE。 （在 Windows 中，要使用 `python` 或 `py` 而不是 `pythonw` 或 `pyw`。） 这样二级子进程将会被附加到该窗口进行输入和输出。

如果 `sys` 被用户代码重置，例如使用了 `importlib.reload(sys)`，则 IDLE 的修改将丢失，来自键盘的输入和向屏幕的输出将无法正确运作。

当 Shell 获得焦点时，它将控制键盘与屏幕。 这通常会保持透明，但一些直接访问键盘和屏幕的函数将会不起作用。 这也包括那些确定是否有键被按下以及是哪个键被按下的系统专属函数。

在执行进程中运行的 IDLE 代码会向调用栈添加在其他情况下不存在的帧。 IDLE 包装了 `sys.getrecursionlimit` 和 `sys.setrecursionlimit` 以减少额外栈帧的影响。

当用户代码直接或者通过调用 sys.exit 引发 SystemExit 时，IDLE 将返回 Shell 提示符而非完全退出。

### Shell中的用户输出¶

当一个程序输出文本时，结果将由相应的输出设备来确定。 当 IDLE 执行用户代码时，`sys.stdout` 和 `sys.stderr` 会被连接到 IDLE Shell 的显示区。 它的某些特性是从底层的 Tk Text 部件继承而来。 其他特性则是程序所添加的。 总之，Shell 被设计用于开发环境而非生产环境运行。

例如，Shell 绝不会丢弃输出。 一个向 Shell 发送无限输出的程序将最终占满内存，导致内存错误。 作为对比，某些系统文本模式窗口只会保留输出的最后 n 行。 例如，Windows 控制台可由用户设置保留 1 至 9999 行，默认为 300 行。

A Tk Text widget, and hence IDLE's Shell, displays characters (codepoints) in the BMP (Basic Multilingual Plane) subset of Unicode. Which characters are displayed with a proper glyph and which with a replacement box depends on the operating system and installed fonts. Tab characters cause the following text to begin after the next tab stop. (They occur every 8 'characters'). Newline characters cause following text to appear on a new line. Other control characters are ignored or displayed as a space, box, or something else, depending on the operating system and font. (Moving the text cursor through such output with arrow keys may exhibit some surprising spacing behavior.)

    
    
~~~shell
>>> s = 'a\tb\a<\x02><\r>\bc\nd'  # Enter 22 chars.
>>> len(s)
14
>>> s  # Display repr(s)
'a\tb\x07<\x02><\r>\x08c\nd'
>>> print(s, end='')  # Display s as is.
# Result varies by OS and font.  Try it.
~~~

`repr` 函数会被用于表达式值的交互式回显。 它将返回输入字符串的一个修改版本，其中的控制代码、部分 BMP 码位以及所有非 BMP 码位都将被替换为转义代码。 如上面所演示的，它使用户可以辨识字符串中的字符，无论它们会如何显示。

普通的与错误的输出通常会在与代码输入和彼此之间保持区分 (显示于不同的行)。 它们也会分别使用不同的高亮颜色。

对于 SyntaxError 回溯信息，表示检测到错误位置的正常 '^' 标记被替换为带有代表错误的文本颜色高亮。 当从文件运行的代码导致了其他异常时，用户可以右击回溯信息行在 IDLE 编辑器中跳转到相应的行。 如有必要将打开相应的文件。

Shell 具有将输出行折叠为一个 'Squeezed text' 标签的特殊功能。 此功能将自动应用于超过 N 行的输出 (默认 N = 50)。 N 可以在设置对话框中 General 页的 PyShell 区域中修改。 行数更少的输出也可通过在输出上右击来折叠。 此功能适用于过多的输出行数导致滚动操作变慢的情况。

已折叠的输出可通过双击该标签来原地展开。 也可通过右击该标签将其发送到剪贴板或单独的查看窗口。

### 开发 tkinter 应用程序¶

IDLE 有意与标准 Python 保持区别以方便 tkinter 程序的开发。 在标准 Python 中输入 `import tkinter as tk; root = tk.Tk()` 不会显示任何东西。 在 IDLE 中输入同样的代码则会显示一个 tk 窗口。 在标准 Python 中，还必须输入 `root.update()` 才会将窗口显示出来。 IDLE 会在幕后执行同样的方法，每秒大约 20 次，即每隔大约 50 毫秒。 下面输入 `b = tk.Button(root, text='button'); b.pack()`。 在标准 Python 中仍然不会有任何可见的变化，直到输入 `root.update()`。

大多数 tkinter 程序都会运行 `root.mainloop()`，它通常直到 tk 应用被销毁时才会返回。 如果程序是通过 `python -i` 或 IDLE 编辑器运行的，则 `>>>` Shell 提示符将直到 `mainloop()` 返回时才会出现，这时将结束程序的交互。

当通过 IDLE 编辑器运行 tkinter 程序时，可以注释掉 mainloop 调用。 这样将立即回到 Shell 提示符并可与正在运行的应用程序交互。 请记得当在标准 Python 中运行时重新启用 mainloop 调用。

### 在没有子进程的情况下运行¶

在默认情况下，IDLE 是通过一个套接字在单独的子进程中执行用户代码，它将使用内部的环回接口。 这个连接在外部不可见并且不会在互联网上发送或接收数据。 如果防火墙仍然会报警，你完全可以忽略。

如果创建套接字连接的尝试失败，IDLE 将会通知你。 这样的失败可能是暂时性的，但是如果持续存在，问题可能是防火墙阻止了连接或某个系统配置错误。 在问题得到解决之前，可以使用 -n 命令行开关来运行 IDLE。

如果 IDLE 启动时使用了 -n 命令行开关则它将在单个进程中运行并且将不再创建运行 RPC Python 执行服务器的子进程。 这适用于 Python 无法在你的系统平台上创建子进程或 RPC 套接字接口的情况。 但是，在这种模式下用户代码没有与 IDLE 本身相隔离。 而且，当选择 Run/Run Module (F5) 时运行环境也不会重启。 如果你的代码已被修改，你必须为受影响的模块执行 reload() 并重新导入特定的条目 (例如 from foo import baz) 才能让修改生效。 出于这些原因，在可能的情况下最好还是使用默认的子进程来运行 IDLE。

自 3.4 版本弃用.

## 帮助和首选项Help and Preferences¶

### 帮助源¶

Help 菜单项 "IDLE Help" 会显示标准库参考中 IDLE 一章的带格式 HTML 版本。 这些内容放在只读的 tkinter 文本窗口中，与在浏览器中看到的内容类似。 可使用鼠标滚轮、滚动条或上下方向键来浏览文本。 或是点击 TOC (Table of Contents) 按钮并在打开的选项框中选择一个节标题。

Help 菜单项 "Python Docs" 会打开更丰富的帮助源，包括教程，通过 `docs.python.org/x.y` 来访问，其中 'x.y' 是当前运行的 Python 版本。 如果你的系统有此文档的离线副本 (这可能是一个安装选项)，则将打开这个副本。

选定的 URL 可以使用配置 IDLE 对话框的 General 选项卡随时在帮助菜单中添加或移除。

### 首选项设置¶

字体首选项、高亮、按键和通用首选项可通过 Option 菜单的配置 IDLE 项来修改。 非默认的用户设置将保存在用户家目录下的 `.idlerc` 目录中。 用户配置文件错误导致的问题可通过编辑或删除 `.idlerc` 中的一个或多个文件来解决。

在 Font 选项卡中，可以查看使用多种语言的多个字符的示例文本来了解字体或字号效果。 可以编辑示例文本来添加想要的其他字符。 请使用示例文本选择等宽字体。 如果某些字符在 Shell 或编辑器中的显示有问题，可以将它们添加到示例文本的开头并尝试改变字号和字体。

在 Highlights 和 Keys 选项卡中，可以选择内置或自定义的颜色主题和按键集合。 要将更新的内置颜色主题或按键集合与旧版 IDLE 一起使用，可以将其保存为新的自定义主题或按键集合就将可在旧版 IDLE 中使用。

### macOS 上的IDLE¶

在 System Preferences: Dock 中，可以将 "Prefer tabs when opening documents" 设为 "Always"。 但是该设置不能兼容 IDLE 所使用的 tk/tkinter GUI 框架，并会使得部分 IDLE 特性失效。

### 扩展¶

IDLE 可以包含扩展插件。 扩展插件的首选项可通过首选项对话框的 Extensions 选项卡来修改。 请查看 idlelib 目录下 config-extensions.def 的开头来了解详情。 目前唯一的扩展插件是 zzdummy，它也是一个测试用的示例。

## idlelib¶

**源代码:** [Lib/idlelib](https://github.com/python/cpython/tree/3.12/Lib/idlelib)

* * *

Lib/idlelib 包实现了 IDLE 应用程序。 请查看本页面的其余的内容来了解如何使用 IDLE。

有关 idlelib 中文件的描述见 idlelib/README.txt。 可以在 idlelib 中或者在 IDLE 中点击 Help => About IDLE 来查看它。 此文件还将 IDLE 菜单条目映射到了实现这些条目的代码。 除了在 'Startup' 中列出的文件以外，idlelib 代码都是 '私有' 的意即特性的修改可以被向下移植 (参见 [**PEP 434**](https://peps.python.org/pep-0434/))。

