# What's New In Python 3.13¶

Editor:


TBD

This article explains the new features in Python 3.13, compared to 3.12.

For full details, see the [changelog](changelog.md#changelog).

备注

Prerelease users should be aware that this document is currently in draft form. It will be updated substantially as Python 3.13 moves towards release, so it's worth checking back even after reading earlier versions.

## Summary -- Release highlights¶

## New Features¶

## Other Language Changes¶

  * Allow the _count_ argument of [`str.replace()`](stdtypes.md#str.replace "str.replace") to be a keyword. (Contributed by Hugo van Kemenade in [gh-106487](https://github.com/python/cpython/issues/106487).)

  * Compiler now strip indents from docstrings. This will reduce the size of [bytecode cache](../glossary.md#term-bytecode) (e.g. `.pyc` file). For example, cache file size for `sqlalchemy.orm.session` in SQLAlchemy 2.0 is reduced by about 5%. This change will affect tools using docstrings, like [`doctest`](doctest.md#module-doctest "doctest: Test pieces of code within docstrings."). (Contributed by Inada Naoki in [gh-81283](https://github.com/python/cpython/issues/81283).)

  * The [`compile()`](functions.md#compile "compile") built-in can now accept a new flag, `ast.PyCF_OPTIMIZED_AST`, which is similar to `ast.PyCF_ONLY_AST` except that the returned `AST` is optimized according to the value of the `optimize` argument. (Contributed by Irit Katriel in [gh-108113](https://github.com/python/cpython/issues/108113)).

## New Modules¶

  * None yet.

## Improved Modules¶

### ast¶

  * [`ast.parse()`](ast.md#ast.parse "ast.parse") now accepts an optional argument `optimize` which is passed on to the [`compile()`](functions.md#compile "compile") built-in. This makes it possible to obtain an optimized `AST`. (Contributed by Irit Katriel in [gh-108113](https://github.com/python/cpython/issues/108113)).

### array¶

  * Add `'w'` type code (`Py_UCS4`) that can be used for Unicode strings. It can be used instead of `'u'` type code, which is deprecated. (Contributed by Inada Naoki in [gh-80480](https://github.com/python/cpython/issues/80480).)

### copy¶

  * Add [`copy.replace()`](copy.md#copy.replace "copy.replace") function which allows to create a modified copy of an object, which is especially usefule for immutable objects. It supports named tuples created with the factory function [`collections.namedtuple()`](collections.md#collections.namedtuple "collections.namedtuple"), [`dataclass`](dataclasses.md#dataclasses.dataclass "dataclasses.dataclass") instances, various [`datetime`](3.标准库/datetime.md#module-datetime "datetime: Basic date and time types.") objects, [`Signature`](inspect.md#inspect.Signature "inspect.Signature") objects, [`Parameter`](inspect.md#inspect.Parameter "inspect.Parameter") objects, [code object](datamodel.md#code-objects), and any user classes which define the `__replace__()` method. (Contributed by Serhiy Storchaka in [gh-108751](https://github.com/python/cpython/issues/108751).)

### dbm¶

  * Add [`dbm.gnu.gdbm.clear()`](dbm.md#dbm.gnu.gdbm.clear "dbm.gnu.gdbm.clear") and [`dbm.ndbm.ndbm.clear()`](dbm.md#dbm.ndbm.ndbm.clear "dbm.ndbm.ndbm.clear") methods that remove all items from the database. (Contributed by Dong-hee Na in [gh-107122](https://github.com/python/cpython/issues/107122).)

### doctest¶

  * The [`doctest.DocTestRunner.run()`](doctest.md#doctest.DocTestRunner.run "doctest.DocTestRunner.run") method now counts the number of skipped tests. Add [`doctest.DocTestRunner.skips`](doctest.md#doctest.DocTestRunner.skips "doctest.DocTestRunner.skips") and [`doctest.TestResults.skipped`](doctest.md#doctest.TestResults.skipped "doctest.TestResults.skipped") attributes. (Contributed by Victor Stinner in [gh-108794](https://github.com/python/cpython/issues/108794).)

### io¶

The [`io.IOBase`](io.md#io.IOBase "io.IOBase") finalizer now logs the `close()` method errors with [`sys.unraisablehook`](3.标准库/sys.md#sys.unraisablehook "sys.unraisablehook"). Previously, errors were ignored silently by default, and only logged in [Python Development Mode](devmode.md#devmode) or on [Python built on debug mode](configure.md#debug-build). (Contributed by Victor Stinner in [gh-62948](https://github.com/python/cpython/issues/62948).)

### opcode¶

  * Move `opcode.ENABLE_SPECIALIZATION` to `_opcode.ENABLE_SPECIALIZATION`. This field was added in 3.12, it was never documented and is not intended for external usage. (Contributed by Irit Katriel in [gh-105481](https://github.com/python/cpython/issues/105481).)

  * Removed `opcode.is_pseudo`, `opcode.MIN_PSEUDO_OPCODE` and `opcode.MAX_PSEUDO_OPCODE`, which were added in 3.12, were never documented or exposed through `dis`, and were not intended to be used externally.

### pathlib¶

  * Add [`pathlib.UnsupportedOperation`](pathlib.md#pathlib.UnsupportedOperation "pathlib.UnsupportedOperation"), which is raised instead of [`NotImplementedError`](3.标准库/exceptions.md#NotImplementedError "NotImplementedError") when a path operation isn't supported. (Contributed by Barney Gale in [gh-89812](https://github.com/python/cpython/issues/89812).)

  * Add support for recursive wildcards in [`pathlib.PurePath.match()`](pathlib.md#pathlib.PurePath.match "pathlib.PurePath.match"). (Contributed by Barney Gale in [gh-73435](https://github.com/python/cpython/issues/73435).)

  * Add _follow_symlinks_ keyword-only argument to [`pathlib.Path.glob()`](pathlib.md#pathlib.Path.glob "pathlib.Path.glob"), [`rglob()`](pathlib.md#pathlib.Path.rglob "pathlib.Path.rglob"), [`is_file()`](pathlib.md#pathlib.Path.is_file "pathlib.Path.is_file"), and [`is_dir()`](pathlib.md#pathlib.Path.is_dir "pathlib.Path.is_dir"). (Contributed by Barney Gale in [gh-77609](https://github.com/python/cpython/issues/77609) and [gh-105793](https://github.com/python/cpython/issues/105793).)

### pdb¶

  * Add ability to move between chained exceptions during post mortem debugging in [`pm()`](pdb.md#pdb.pm "pdb.pm") using the new `exceptions [exc_number]` command for Pdb. (Contributed by Matthias Bussonnier in [gh-106676](https://github.com/python/cpython/issues/106676).)

  * Expressions/Statements whose prefix is a pdb command are now correctly identified and executed. (Contributed by Tian Gao in [gh-108464](https://github.com/python/cpython/issues/108464).)

### sqlite3¶

  * A [`ResourceWarning`](3.标准库/exceptions.md#ResourceWarning "ResourceWarning") is now emitted if a [`sqlite3.Connection`](sqlite3.md#sqlite3.Connection "sqlite3.Connection") object is not [`closed`](sqlite3.md#sqlite3.Connection.close "sqlite3.Connection.close") explicitly. (Contributed by Erlend E. Aasland in [gh-105539](https://github.com/python/cpython/issues/105539).)

### tkinter¶

  * Add [`tkinter`](tkinter.md#module-tkinter "tkinter: Interface to Tcl/Tk for graphical user interfaces") widget methods: `tk_busy_hold()`, `tk_busy_configure()`, `tk_busy_cget()`, `tk_busy_forget()`, `tk_busy_current()`, and `tk_busy_status()`. (Contributed by Miguel, klappnase and Serhiy Storchaka in [gh-72684](https://github.com/python/cpython/issues/72684).)

### traceback¶

  * Add _show_group_ paramter to [`traceback.TracebackException.format_exception_only()`](traceback.md#traceback.TracebackException.format_exception_only "traceback.TracebackException.format_exception_only") to format the nested exceptions of a [`BaseExceptionGroup`](3.标准库/exceptions.md#BaseExceptionGroup "BaseExceptionGroup") instance, recursively. (Contributed by Irit Katriel in [gh-105292](https://github.com/python/cpython/issues/105292).)

### typing¶

  * Add [`typing.get_protocol_members()`](typing.md#typing.get_protocol_members "typing.get_protocol_members") to return the set of members defining a [`typing.Protocol`](typing.md#typing.Protocol "typing.Protocol"). Add [`typing.is_protocol()`](typing.md#typing.is_protocol "typing.is_protocol") to check whether a class is a [`typing.Protocol`](typing.md#typing.Protocol "typing.Protocol"). (Contributed by Jelle Zijlstra in [gh-104873](https://github.com/python/cpython/issues/104873).)

### venv¶

  * Add support for adding source control management (SCM) ignore files to a virtual environment's directory. By default, Git is supported. This is implemented as opt-in via the API which can be extended to support other SCMs ([`venv.EnvBuilder`](3.标准库/venv.md#venv.EnvBuilder "venv.EnvBuilder") and [`venv.create()`](3.标准库/venv.md#venv.create "venv.create")), and opt-out via the CLI (using `--without-scm-ignore-files`). (Contributed by Brett Cannon in [gh-108125](https://github.com/python/cpython/issues/108125).)

## Optimizations¶

  * [`textwrap.indent()`](textwrap.md#textwrap.indent "textwrap.indent") is now ~30% faster than before for large input. (Contributed by Inada Naoki in [gh-107369](https://github.com/python/cpython/issues/107369).)

## Deprecated¶

  * [`array`](array.md#module-array "array: Space efficient arrays of uniformly typed numeric values."): [`array`](array.md#module-array "array: Space efficient arrays of uniformly typed numeric values.")'s `'u'` format code, deprecated in docs since Python 3.3, emits [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") since 3.13 and will be removed in Python 3.16. Use the `'w'` format code instead. (contributed by Hugo van Kemenade in [gh-80480](https://github.com/python/cpython/issues/80480))

  * [`ctypes`](ctypes.md#module-ctypes "ctypes: A foreign function library for Python."): Deprecate undocumented `ctypes.SetPointerType()` and `ctypes.ARRAY()` functions. Replace `ctypes.ARRAY(item_type, size)` with `item_type * size`. (Contributed by Victor Stinner in [gh-105733](https://github.com/python/cpython/issues/105733).)

  * [`getopt`](getopt.md#module-getopt "getopt: Portable parser for command line options; support both short and long option names.") and [`optparse`](optparse.md#module-optparse "optparse: Command-line option parsing library.（已弃用）") modules: They are now [soft deprecated](../glossary.md#term-soft-deprecated): the [`argparse`](3.标准库/argparse.md#module-argparse "argparse: Command-line option and argument parsing library.") should be used for new projects. Previously, the [`optparse`](optparse.md#module-optparse "optparse: Command-line option parsing library.（已弃用）") module was already deprecated, its removal was not scheduled, and no warnings was emitted: so there is no change in practice. (Contributed by Victor Stinner in [gh-106535](https://github.com/python/cpython/issues/106535).)

  * [`http.server`](http.server.md#module-http.server "http.server: HTTP server and request handlers."): [`http.server.CGIHTTPRequestHandler`](http.server.md#http.server.CGIHTTPRequestHandler "http.server.CGIHTTPRequestHandler") now emits a [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") as it will be removed in 3.15. Process based CGI http servers have been out of favor for a very long time. This code was outdated, unmaintained, and rarely used. It has a high potential for both security and functionality bugs. This includes removal of the `--cgi` flag to the `python -m http.server` command line in 3.15.

  * [`typing`](typing.md#module-typing "typing: Support for type hints \(see :pep:`484`\)."): Creating a [`typing.NamedTuple`](typing.md#typing.NamedTuple "typing.NamedTuple") class using keyword arguments to denote the fields (`NT = NamedTuple("NT", x=int, y=int)`) is deprecated, and will be disallowed in Python 3.15. Use the class-based syntax or the functional syntax instead. (Contributed by Alex Waygood in [gh-105566](https://github.com/python/cpython/issues/105566).)

    * When using the functional syntax to create a [`typing.NamedTuple`](typing.md#typing.NamedTuple "typing.NamedTuple") class or a [`typing.TypedDict`](typing.md#typing.TypedDict "typing.TypedDict") class, failing to pass a value to the 'fields' parameter (`NT = NamedTuple("NT")` or `TD = TypedDict("TD")`) is deprecated. Passing `None` to the 'fields' parameter (`NT = NamedTuple("NT", None)` or `TD = TypedDict("TD", None)`) is also deprecated. Both will be disallowed in Python 3.15. To create a NamedTuple class with 0 fields, use `class NT(NamedTuple): pass` or `NT = NamedTuple("NT", [])`. To create a TypedDict class with 0 fields, use `class TD(TypedDict): pass` or `TD = TypedDict("TD", {})`. (Contributed by Alex Waygood in [gh-105566](https://github.com/python/cpython/issues/105566) and [gh-105570](https://github.com/python/cpython/issues/105570).)

    * [`typing.no_type_check_decorator()`](typing.md#typing.no_type_check_decorator "typing.no_type_check_decorator") is deprecated, and scheduled for removal in Python 3.15. After eight years in the [`typing`](typing.md#module-typing "typing: Support for type hints \(see :pep:`484`\).") module, it has yet to be supported by any major type checkers. (Contributed by Alex Waygood in [gh-106309](https://github.com/python/cpython/issues/106309).)

    * [`typing.AnyStr`](typing.md#typing.AnyStr "typing.AnyStr") is deprecated. In Python 3.16, it will be removed from `typing.__all__`, and a [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") will be emitted when it is imported or accessed. It will be removed entirely in Python 3.18. Use the new [type parameter syntax](compound_stmts.md#type-params) instead. (Contributed by Michael The in [gh-107116](https://github.com/python/cpython/issues/107116).)

  * [`wave`](wave.md#module-wave "wave: Provide an interface to the WAV sound format."): Deprecate the `getmark()`, `setmark()` and `getmarkers()` methods of the [`wave.Wave_read`](wave.md#wave.Wave_read "wave.Wave_read") and [`wave.Wave_write`](wave.md#wave.Wave_write "wave.Wave_write") classes. They will be removed in Python 3.15. (Contributed by Victor Stinner in [gh-105096](https://github.com/python/cpython/issues/105096).)

  * Passing more than one positional argument to [`sqlite3.connect()`](sqlite3.md#sqlite3.connect "sqlite3.connect") and the [`sqlite3.Connection`](sqlite3.md#sqlite3.Connection "sqlite3.Connection") constructor is deprecated. The remaining parameters will become keyword-only in Python 3.15.

Deprecate passing name, number of arguments, and the callable as keyword arguments, for the following [`sqlite3.Connection`](sqlite3.md#sqlite3.Connection "sqlite3.Connection") APIs:

    * [`create_function()`](../library/sqlite3.md#sqlite3.Connection.create_function "sqlite3.Connection.create_function")

    * [`create_aggregate()`](../library/sqlite3.md#sqlite3.Connection.create_aggregate "sqlite3.Connection.create_aggregate")

Deprecate passing the callback callable by keyword for the following [`sqlite3.Connection`](sqlite3.md#sqlite3.Connection "sqlite3.Connection") APIs:

    * [`set_authorizer()`](../library/sqlite3.md#sqlite3.Connection.set_authorizer "sqlite3.Connection.set_authorizer")

    * [`set_progress_handler()`](../library/sqlite3.md#sqlite3.Connection.set_progress_handler "sqlite3.Connection.set_progress_handler")

    * [`set_trace_callback()`](../library/sqlite3.md#sqlite3.Connection.set_trace_callback "sqlite3.Connection.set_trace_callback")

The affected parameters will become positional-only in Python 3.15.

(Contributed by Erlend E. Aasland in [gh-107948](https://github.com/python/cpython/issues/107948) and [gh-108278](https://github.com/python/cpython/issues/108278).)

  * The `dis.HAVE_ARGUMENT` separator is deprecated. Check membership in [`hasarg`](dis.md#dis.hasarg "dis.hasarg") instead. (Contributed by Irit Katriel in [gh-109319](https://github.com/python/cpython/issues/109319).)

### Pending Removal in Python 3.14¶

  * [`argparse`](3.标准库/argparse.md#module-argparse "argparse: Command-line option and argument parsing library."): The _type_ , _choices_ , and _metavar_ parameters of `argparse.BooleanOptionalAction` are deprecated and will be removed in 3.14. (Contributed by Nikita Sobolev in [gh-92248](https://github.com/python/cpython/issues/92248).)

  * [`ast`](ast.md#module-ast "ast: Abstract Syntax Tree classes and manipulation."): The following features have been deprecated in documentation since Python 3.8, now cause a [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") to be emitted at runtime when they are accessed or used, and will be removed in Python 3.14:

    * `ast.Num`

    * `ast.Str`

    * `ast.Bytes`

    * `ast.NameConstant`

    * `ast.Ellipsis`

Use [`ast.Constant`](ast.md#ast.Constant "ast.Constant") instead. (Contributed by Serhiy Storchaka in [gh-90953](https://github.com/python/cpython/issues/90953).)

  * [`collections.abc`](collections.abc.md#module-collections.abc "collections.abc: Abstract base classes for containers"): Deprecated [`ByteString`](collections.abc.md#collections.abc.ByteString "collections.abc.ByteString"). Prefer `Sequence` or [`Buffer`](collections.abc.md#collections.abc.Buffer "collections.abc.Buffer"). For use in typing, prefer a union, like `bytes | bytearray`, or [`collections.abc.Buffer`](collections.abc.md#collections.abc.Buffer "collections.abc.Buffer"). (Contributed by Shantanu Jain in [gh-91896](https://github.com/python/cpython/issues/91896).)

  * [`email`](email.md#module-email "email: Package supporting the parsing, manipulating, and generating email messages."): Deprecated the _isdst_ parameter in [`email.utils.localtime()`](email.utils.md#email.utils.localtime "email.utils.localtime"). (Contributed by Alan Williams in [gh-72346](https://github.com/python/cpython/issues/72346).)

  * [`importlib`](importlib.md#module-importlib "importlib: The implementation of the import machinery."): `__package__` and `__cached__` will cease to be set or taken into consideration by the import system ([gh-97879](https://github.com/python/cpython/issues/97879)).

  * [`importlib.abc`](importlib.md#module-importlib.abc "importlib.abc: Abstract base classes related to import") deprecated classes:

    * `importlib.abc.ResourceReader`

    * `importlib.abc.Traversable`

    * `importlib.abc.TraversableResources`

Use [`importlib.resources.abc`](importlib.resources.abc.md#module-importlib.resources.abc "importlib.resources.abc: Abstract base classes for resources") classes instead:

    * [`importlib.resources.abc.Traversable`](../library/importlib.resources.abc.md#importlib.resources.abc.Traversable "importlib.resources.abc.Traversable")

    * [`importlib.resources.abc.TraversableResources`](../library/importlib.resources.abc.md#importlib.resources.abc.TraversableResources "importlib.resources.abc.TraversableResources")

(Contributed by Jason R. Coombs and Hugo van Kemenade in [gh-93963](https://github.com/python/cpython/issues/93963).)

  * [`itertools`](itertools.md#module-itertools "itertools: Functions creating iterators for efficient looping.") had undocumented, inefficient, historically buggy, and inconsistent support for copy, deepcopy, and pickle operations. This will be removed in 3.14 for a significant reduction in code volume and maintenance burden. (Contributed by Raymond Hettinger in [gh-101588](https://github.com/python/cpython/issues/101588).)

  * [`multiprocessing`](multiprocessing.md#module-multiprocessing "multiprocessing: Process-based parallelism."): The default start method will change to a safer one on Linux, BSDs, and other non-macOS POSIX platforms where `'fork'` is currently the default ([gh-84559](https://github.com/python/cpython/issues/84559)). Adding a runtime warning about this was deemed too disruptive as the majority of code is not expected to care. Use the [`get_context()`](multiprocessing.md#multiprocessing.get_context "multiprocessing.get_context") or [`set_start_method()`](multiprocessing.md#multiprocessing.set_start_method "multiprocessing.set_start_method") APIs to explicitly specify when your code _requires_ `'fork'`. See [上下文和启动方法](multiprocessing.md#multiprocessing-start-methods).

  * [`pathlib`](pathlib.md#module-pathlib "pathlib: Object-oriented filesystem paths"): [`is_relative_to()`](pathlib.md#pathlib.PurePath.is_relative_to "pathlib.PurePath.is_relative_to"), [`relative_to()`](pathlib.md#pathlib.PurePath.relative_to "pathlib.PurePath.relative_to"): passing additional arguments is deprecated.

  * [`pkgutil.find_loader()`](pkgutil.md#pkgutil.find_loader "pkgutil.find_loader") and [`pkgutil.get_loader()`](pkgutil.md#pkgutil.get_loader "pkgutil.get_loader") now raise [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning"); use [`importlib.util.find_spec()`](importlib.md#importlib.util.find_spec "importlib.util.find_spec") instead. (Contributed by Nikita Sobolev in [gh-97850](https://github.com/python/cpython/issues/97850).)

  * [`pty`](pty.md#module-pty "pty: Pseudo-Terminal Handling for Unix. \(Unix\)"):

    * `master_open()`: use [`pty.openpty()`](pty.md#pty.openpty "pty.openpty").

    * `slave_open()`: use [`pty.openpty()`](pty.md#pty.openpty "pty.openpty").

  * [`shutil.rmtree()`](shutil.md#shutil.rmtree "shutil.rmtree") _onerror_ parameter is deprecated in 3.12, and will be removed in 3.14: use the _onexc_ parameter instead.

  * [`sqlite3`](sqlite3.md#module-sqlite3 "sqlite3: A DB-API 2.0 implementation using SQLite 3.x."):

    * [`version`](sqlite3.md#sqlite3.version "sqlite3.version") and [`version_info`](sqlite3.md#sqlite3.version_info "sqlite3.version_info").

    * [`execute()`](sqlite3.md#sqlite3.Cursor.execute "sqlite3.Cursor.execute") and [`executemany()`](sqlite3.md#sqlite3.Cursor.executemany "sqlite3.Cursor.executemany") if [named placeholders](sqlite3.md#sqlite3-placeholders) are used and _parameters_ is a sequence instead of a [`dict`](stdtypes.md#dict "dict").

    * date and datetime adapter, date and timestamp converter: see the [`sqlite3`](sqlite3.md#module-sqlite3 "sqlite3: A DB-API 2.0 implementation using SQLite 3.x.") documentation for suggested replacement recipes.

  * [`types.CodeType`](types.md#types.CodeType "types.CodeType"): Accessing `co_lnotab` was deprecated in [**PEP 626**](https://peps.python.org/pep-0626/) since 3.10 and was planned to be removed in 3.12, but it only got a proper [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") in 3.12. May be removed in 3.14. (Contributed by Nikita Sobolev in [gh-101866](https://github.com/python/cpython/issues/101866).)

  * [`typing`](typing.md#module-typing "typing: Support for type hints \(see :pep:`484`\)."): [`ByteString`](typing.md#typing.ByteString "typing.ByteString"), deprecated since Python 3.9, now causes a [`DeprecationWarning`](3.标准库/exceptions.md#DeprecationWarning "DeprecationWarning") to be emitted when it is used.

  * `urllib.parse.Quoter` is deprecated: it was not intended to be a public API. (Contributed by Gregory P. Smith in [gh-88168](https://github.com/python/cpython/issues/88168).)

  * [`xml.etree.ElementTree`](xml.etree.elementtree.md#module-xml.etree.ElementTree "xml.etree.ElementTree: Implementation of the ElementTree API."): Testing the truth value of an [`Element`](xml.etree.elementtree.md#xml.etree.ElementTree.Element "xml.etree.ElementTree.Element") is deprecated and will raise an exception in Python 3.14.

### Pending Removal in Python 3.15¶

  * [`http.server.CGIHTTPRequestHandler`](http.server.md#http.server.CGIHTTPRequestHandler "http.server.CGIHTTPRequestHandler") will be removed along with its related `--cgi` flag to `python -m http.server`. It was obsolete and rarely used. No direct replacement exists. _Anything_ is better than CGI to interface a web server with a request handler.

  * [`typing.NamedTuple`](typing.md#typing.NamedTuple "typing.NamedTuple"):

    * The undocumented keyword argument syntax for creating NamedTuple classes (`NT = NamedTuple("NT", x=int)`) is deprecated, and will be disallowed in 3.15. Use the class-based syntax or the functional syntax instead.

    * When using the functional syntax to create a NamedTuple class, failing to pass a value to the 'fields' parameter (`NT = NamedTuple("NT")`) is deprecated. Passing `None` to the 'fields' parameter (`NT = NamedTuple("NT", None)`) is also deprecated. Both will be disallowed in Python 3.15. To create a NamedTuple class with 0 fields, use `class NT(NamedTuple): pass` or `NT = NamedTuple("NT", [])`.

  * [`typing.TypedDict`](typing.md#typing.TypedDict "typing.TypedDict"): When using the functional syntax to create a TypedDict class, failing to pass a value to the 'fields' parameter (`TD = TypedDict("TD")`) is deprecated. Passing `None` to the 'fields' parameter (`TD = TypedDict("TD", None)`) is also deprecated. Both will be disallowed in Python 3.15. To create a TypedDict class with 0 fields, use `class TD(TypedDict): pass` or `TD = TypedDict("TD", {})`.

  * [`wave`](wave.md#module-wave "wave: Provide an interface to the WAV sound format."): Deprecate the `getmark()`, `setmark()` and `getmarkers()` methods of the [`wave.Wave_read`](wave.md#wave.Wave_read "wave.Wave_read") and [`wave.Wave_write`](wave.md#wave.Wave_write "wave.Wave_write") classes. They will be removed in Python 3.15. (Contributed by Victor Stinner in [gh-105096](https://github.com/python/cpython/issues/105096).)

  * Passing any arguments to [`threading.RLock()`](threading.md#threading.RLock "threading.RLock") is now deprecated. C version allows any numbers of args and kwargs, but they are just ignored. Python version does not allow any arguments. All arguments will be removed from [`threading.RLock()`](threading.md#threading.RLock "threading.RLock") in Python 3.15. (Contributed by Nikita Sobolev in [gh-102029](https://github.com/python/cpython/issues/102029).)

### Pending Removal in Python 3.16¶

  * [`array.array`](array.md#array.array "array.array") `'u'` type (`wchar_t`): use the `'w'` type instead (`Py_UCS4`).

### Pending Removal in Future Versions¶

The following APIs were deprecated in earlier Python versions and will be removed, although there is currently no date scheduled for their removal.

  * [`argparse`](3.标准库/argparse.md#module-argparse "argparse: Command-line option and argument parsing library."): Nesting argument groups and nesting mutually exclusive groups are deprecated.

  * [`builtins`](builtins.md#module-builtins "builtins: The module that provides the built-in namespace."):

    * `~bool`, bitwise inversion on bool.

    * `bool(NotImplemented)`.

    * Generators: `throw(type, exc, tb)` and `athrow(type, exc, tb)` signature is deprecated: use `throw(exc)` and `athrow(exc)` instead, the single argument signature.

    * Currently Python accepts numeric literals immediately followed by keywords, for example `0in x`, `1or x`, `0if 1else 2`. It allows confusing and ambiguous expressions like `[0x1for x in y]` (which can be interpreted as `[0x1 for x in y]` or `[0x1f or x in y]`). A syntax warning is raised if the numeric literal is immediately followed by one of keywords [`and`](expressions.md#and), [`else`](compound_stmts.md#else), [`for`](compound_stmts.md#for), [`if`](compound_stmts.md#if), [`in`](expressions.md#in), [`is`](expressions.md#is) and [`or`](expressions.md#or). In a future release it will be changed to a syntax error. ([gh-87999](https://github.com/python/cpython/issues/87999))

    * Support for `__index__()` and `__int__()` method returning non-int type: these methods will be required to return an instance of a strict subclass of [`int`](functions.md#int "int").

    * Support for `__float__()` method returning a strict subclass of [`float`](functions.md#float "float"): these methods will be required to return an instance of [`float`](functions.md#float "float").

    * Support for `__complex__()` method returning a strict subclass of [`complex`](functions.md#complex "complex"): these methods will be required to return an instance of [`complex`](functions.md#complex "complex").

    * Delegation of `int()` to `__trunc__()` method.

  * [`calendar`](calendar.md#module-calendar "calendar: Functions for working with calendars, including some emulation of the Unix cal program."): `calendar.January` and `calendar.February` constants are deprecated and replaced by [`calendar.JANUARY`](calendar.md#calendar.JANUARY "calendar.JANUARY") and [`calendar.FEBRUARY`](calendar.md#calendar.FEBRUARY "calendar.FEBRUARY"). (Contributed by Prince Roshan in [gh-103636](https://github.com/python/cpython/issues/103636).)

  * [`datetime`](3.标准库/datetime.md#module-datetime "datetime: Basic date and time types."):

    * [`utcnow()`](3.标准库/datetime.md#datetime.datetime.utcnow "datetime.datetime.utcnow"): use `datetime.datetime.now(tz=datetime.UTC)`.

    * [`utcfromtimestamp()`](3.标准库/datetime.md#datetime.datetime.utcfromtimestamp "datetime.datetime.utcfromtimestamp"): use `datetime.datetime.fromtimestamp(timestamp, tz=datetime.UTC)`.

  * [`gettext`](gettext.md#module-gettext "gettext: Multilingual internationalization services."): Plural value must be an integer.

  * [`importlib`](importlib.md#module-importlib "importlib: The implementation of the import machinery."):

    * `load_module()` method: use `exec_module()` instead.

    * [`cache_from_source()`](importlib.md#importlib.util.cache_from_source "importlib.util.cache_from_source") _debug_override_ parameter is deprecated: use the _optimization_ parameter instead.

  * [`importlib.metadata`](importlib.metadata.md#module-importlib.metadata "importlib.metadata: Accessing package metadata"):

    * `EntryPoints` tuple interface.

    * Implicit `None` on return values.

  * [`importlib.resources`](importlib.resources.md#module-importlib.resources "importlib.resources: Package resource reading, opening, and access"): First parameter to files is renamed to 'anchor'.

  * [`importlib.resources`](importlib.resources.md#module-importlib.resources "importlib.resources: Package resource reading, opening, and access") deprecated methods:

    * `contents()`

    * `is_resource()`

    * `open_binary()`

    * `open_text()`

    * `path()`

    * `read_binary()`

    * `read_text()`

Use `files()` instead. Refer to [importlib-resources: Migrating from Legacy](https://importlib-resources.readthedocs.io/en/latest/using.md#migrating-from-legacy) for migration advice.

  * [`locale.getdefaultlocale()`](locale.md#locale.getdefaultlocale "locale.getdefaultlocale"): use [`locale.setlocale()`](locale.md#locale.setlocale "locale.setlocale"), [`locale.getencoding()`](locale.md#locale.getencoding "locale.getencoding") and [`locale.getlocale()`](locale.md#locale.getlocale "locale.getlocale") instead ([gh-90817](https://github.com/python/cpython/issues/90817))

  * [`mailbox`](mailbox.md#module-mailbox "mailbox: Manipulate mailboxes in various formats"): Use of StringIO input and text mode is deprecated, use BytesIO and binary mode instead.

  * [`os`](os.md#module-os "os: Miscellaneous operating system interfaces."): Calling [`os.register_at_fork()`](os.md#os.register_at_fork "os.register_at_fork") in multi-threaded process.

  * `pydoc.ErrorDuringImport`: A tuple value for _exc_info_ parameter is deprecated, use an exception instance.

  * [`re`](re.md#module-re "re: Regular expression operations."): More strict rules are now applied for numerical group references and group names in regular expressions. Only sequence of ASCII digits is now accepted as a numerical reference. The group name in bytes patterns and replacement strings can now only contain ASCII letters and digits and underscore. (Contributed by Serhiy Storchaka in [gh-91760](https://github.com/python/cpython/issues/91760).)

  * [`ssl`](ssl.md#module-ssl "ssl: TLS/SSL wrapper for socket objects") options and protocols:

    * [`ssl.SSLContext`](ssl.md#ssl.SSLContext "ssl.SSLContext") without protocol argument is deprecated.

    * [`ssl.SSLContext`](ssl.md#ssl.SSLContext "ssl.SSLContext"): [`set_npn_protocols()`](ssl.md#ssl.SSLContext.set_npn_protocols "ssl.SSLContext.set_npn_protocols") and `~ssl.SSLContext.selected_npn_protocol()` are deprecated: use ALPN instead.

    * `ssl.OP_NO_SSL*` options

    * `ssl.OP_NO_TLS*` options

    * `ssl.PROTOCOL_SSLv3`

    * `ssl.PROTOCOL_TLS`

    * `ssl.PROTOCOL_TLSv1`

    * `ssl.PROTOCOL_TLSv1_1`

    * `ssl.PROTOCOL_TLSv1_2`

    * `ssl.TLSVersion.SSLv3`

    * `ssl.TLSVersion.TLSv1`

    * `ssl.TLSVersion.TLSv1_1`

  * `sre_compile`, `sre_constants` and `sre_parse` modules.

  * `types.CodeType.co_lnotab`: use the `co_lines` attribute instead.

  * [`typing.Text`](typing.md#typing.Text "typing.Text") ([gh-92332](https://github.com/python/cpython/issues/92332)).

  * [`sysconfig.is_python_build()`](sysconfig.md#sysconfig.is_python_build "sysconfig.is_python_build") _check_home_ parameter is deprecated and ignored.

  * [`threading`](threading.md#module-threading "threading: Thread-based parallelism.") methods:

    * `threading.Condition.notifyAll()`: use [`notify_all()`](threading.md#threading.Condition.notify_all "threading.Condition.notify_all").

    * `threading.Event.isSet()`: use [`is_set()`](threading.md#threading.Event.is_set "threading.Event.is_set").

    * `threading.Thread.isDaemon()`, [`threading.Thread.setDaemon()`](threading.md#threading.Thread.setDaemon "threading.Thread.setDaemon"): use [`threading.Thread.daemon`](threading.md#threading.Thread.daemon "threading.Thread.daemon") attribute.

    * `threading.Thread.getName()`, [`threading.Thread.setName()`](threading.md#threading.Thread.setName "threading.Thread.setName"): use [`threading.Thread.name`](threading.md#threading.Thread.name "threading.Thread.name") attribute.

    * `threading.currentThread()`: use [`threading.current_thread()`](threading.md#threading.current_thread "threading.current_thread").

    * `threading.activeCount()`: use [`threading.active_count()`](threading.md#threading.active_count "threading.active_count").

  * [`unittest.IsolatedAsyncioTestCase`](unittest.md#unittest.IsolatedAsyncioTestCase "unittest.IsolatedAsyncioTestCase"): it is deprecated to return a value that is not None from a test case.

  * [`urllib.request`](urllib.request.md#module-urllib.request "urllib.request: Extensible library for opening URLs."): [`URLopener`](urllib.request.md#urllib.request.URLopener "urllib.request.URLopener") and [`FancyURLopener`](urllib.request.md#urllib.request.FancyURLopener "urllib.request.FancyURLopener") style of invoking requests is deprecated. Use newer [`urlopen()`](urllib.request.md#urllib.request.urlopen "urllib.request.urlopen") functions and methods.

  * `urllib.parse.to_bytes()`.

  * [`urllib.parse`](urllib.parse.md#module-urllib.parse "urllib.parse: Parse URLs into or assemble them from components.") deprecated functions: [`urlparse()`](urllib.parse.md#urllib.parse.urlparse "urllib.parse.urlparse") instead

    * `splitattr()`

    * `splithost()`

    * `splitnport()`

    * `splitpasswd()`

    * `splitport()`

    * `splitquery()`

    * `splittag()`

    * `splittype()`

    * `splituser()`

    * `splitvalue()`

  * [`wsgiref`](wsgiref.md#module-wsgiref "wsgiref: WSGI Utilities and Reference Implementation."): `SimpleHandler.stdout.write()` should not do partial writes.

  * [`zipimport.zipimporter.load_module()`](zipimport.md#zipimport.zipimporter.load_module "zipimport.zipimporter.load_module") is deprecated: use [`exec_module()`](zipimport.md#zipimport.zipimporter.exec_module "zipimport.zipimporter.exec_module") instead.

## Removed¶

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `telnetlib` module, deprecated in Python 3.11: use the projects [telnetlib3](https://pypi.org/project/telnetlib3/) or [Exscript](https://pypi.org/project/Exscript/) instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * Remove the `2to3` program and the `lib2to3` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104780](https://github.com/python/cpython/issues/104780).)

  * Namespaces `typing.io` and `typing.re`, deprecated in Python 3.8, are now removed. The items in those namespaces can be imported directly from [`typing`](typing.md#module-typing "typing: Support for type hints \(see :pep:`484`\)."). (Contributed by Sebastian Rittau in [gh-92871](https://github.com/python/cpython/issues/92871).)

  * Remove the untested and undocumented [`webbrowser`](webbrowser.md#module-webbrowser "webbrowser: Easy-to-use controller for web browsers.") `MacOSX` class, deprecated in Python 3.11. Use the `MacOSXOSAScript` class (introduced in Python 3.2) instead. (Contributed by Hugo van Kemenade in [gh-104804](https://github.com/python/cpython/issues/104804).)

  * Remove support for using [`pathlib.Path`](pathlib.md#pathlib.Path "pathlib.Path") objects as context managers. This functionality was deprecated and made a no-op in Python 3.9.

  * Remove the undocumented `configparser.LegacyInterpolation` class, deprecated in the docstring since Python 3.2, and with a deprecation warning since Python 3.11. (Contributed by Hugo van Kemenade in [gh-104886](https://github.com/python/cpython/issues/104886).)

  * Remove the `turtle.RawTurtle.settiltangle()` method, deprecated in docs since Python 3.1 and with a deprecation warning since Python 3.11. (Contributed by Hugo van Kemenade in [gh-104876](https://github.com/python/cpython/issues/104876).)

  * Removed the following [`unittest`](unittest.md#module-unittest "unittest: Unit testing framework for Python.") functions, deprecated in Python 3.11:

    * `unittest.findTestCases()`

    * `unittest.makeSuite()`

    * `unittest.getTestCaseNames()`

Use [`TestLoader`](unittest.md#unittest.TestLoader "unittest.TestLoader") methods instead:

    * [`unittest.TestLoader.loadTestsFromModule()`](../library/unittest.md#unittest.TestLoader.loadTestsFromModule "unittest.TestLoader.loadTestsFromModule")

    * [`unittest.TestLoader.loadTestsFromTestCase()`](../library/unittest.md#unittest.TestLoader.loadTestsFromTestCase "unittest.TestLoader.loadTestsFromTestCase")

    * [`unittest.TestLoader.getTestCaseNames()`](../library/unittest.md#unittest.TestLoader.getTestCaseNames "unittest.TestLoader.getTestCaseNames")

(Contributed by Hugo van Kemenade in [gh-104835](https://github.com/python/cpython/issues/104835).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `cgi` and `cgitb` modules, deprecated in Python 3.11.

    * `cgi.FieldStorage` can typically be replaced with [`urllib.parse.parse_qsl()`](urllib.parse.md#urllib.parse.parse_qsl "urllib.parse.parse_qsl") for `GET` and `HEAD` requests, and the [`email.message`](email.message.md#module-email.message "email.message: The base class representing email messages.") module or [multipart](https://pypi.org/project/multipart/) PyPI project for `POST` and `PUT`.

    * `cgi.parse()` can be replaced by calling [`urllib.parse.parse_qs()`](urllib.parse.md#urllib.parse.parse_qs "urllib.parse.parse_qs") directly on the desired query string, except for `multipart/form-data` input, which can be handled as described for `cgi.parse_multipart()`.

    * `cgi.parse_multipart()` can be replaced with the functionality in the [`email`](email.md#module-email "email: Package supporting the parsing, manipulating, and generating email messages.") package (e.g. [`email.message.EmailMessage`](email.message.md#email.message.EmailMessage "email.message.EmailMessage") and [`email.message.Message`](email.compat32-message.md#email.message.Message "email.message.Message")) which implements the same MIME RFCs, or with the [multipart](https://pypi.org/project/multipart/) PyPI project.

    * `cgi.parse_header()` can be replaced with the functionality in the [`email`](email.md#module-email "email: Package supporting the parsing, manipulating, and generating email messages.") package, which implements the same MIME RFCs. For example, with [`email.message.EmailMessage`](email.message.md#email.message.EmailMessage "email.message.EmailMessage"):
        
                from email.message import EmailMessage
        msg = EmailMessage()
        msg['content-type'] = 'application/json; charset="utf8"'
        main, params = msg.get_content_type(), msg['content-type'].params
~~~

(Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `sndhdr` module, deprecated in Python 3.11: use the projects [filetype](https://pypi.org/project/filetype/), [puremagic](https://pypi.org/project/puremagic/), or [python-magic](https://pypi.org/project/python-magic/) instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `pipes` module, deprecated in Python 3.11: use the [`subprocess`](../library/subprocess.md#module-subprocess "subprocess: Subprocess management.") module instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `ossaudiodev` module, deprecated in Python 3.11: use the [pygame project](https://www.pygame.org/) for audio playback. (Contributed by Victor Stinner in [gh-104780](https://github.com/python/cpython/issues/104780).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `sunau` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `mailcap` module, deprecated in Python 3.11. The [`mimetypes`](../library/mimetypes.md#module-mimetypes "mimetypes: Mapping of filename extensions to MIME types.") module provides an alternative. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `spwd` module, deprecated in Python 3.11: the [python-pam project](https://pypi.org/project/python-pam/) can be used instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `nntplib` module, deprecated in Python 3.11: the [PyPI nntplib project](https://pypi.org/project/nntplib/) can be used instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `nis` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `xdrlib` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `msilib` module, deprecated in Python 3.11. (Contributed by Zachary Ware in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `crypt` module and its private `_crypt` extension, deprecated in Python 3.11. The [`hashlib`](../library/hashlib.md#module-hashlib "hashlib: Secure hash and message digest algorithms.") module is a potential replacement for certain use cases. Otherwise, the following PyPI projects can be used:

    * [bcrypt](https://pypi.org/project/bcrypt/): Modern password hashing for your software and your servers.

    * [passlib](https://pypi.org/project/passlib/): Comprehensive password hashing framework supporting over 30 schemes.

    * [argon2-cffi](https://pypi.org/project/argon2-cffi/): The secure Argon2 password hashing algorithm.

    * [legacycrypt](https://pypi.org/project/legacycrypt/): Wrapper to the POSIX crypt library call and associated functionality.

(Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `uu` module, deprecated in Python 3.11: the [`base64`](../library/base64.md#module-base64 "base64: RFC 4648: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85") module is a modern alternative. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `aifc` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `audioop` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `chunk` module, deprecated in Python 3.11. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * Remove support for the keyword-argument method of creating [`typing.TypedDict`](../library/typing.md#typing.TypedDict "typing.TypedDict") types, deprecated in Python 3.11. (Contributed by Tomas Roun in [gh-104786](https://github.com/python/cpython/issues/104786).)

  * [**PEP 594**](https://peps.python.org/pep-0594/): Remove the `imghdr` module, deprecated in Python 3.11: use the projects [filetype](https://pypi.org/project/filetype/), [puremagic](https://pypi.org/project/puremagic/), or [python-magic](https://pypi.org/project/python-magic/) instead. (Contributed by Victor Stinner in [gh-104773](https://github.com/python/cpython/issues/104773).)

  * Remove the untested and undocumented `unittest.TestProgram.usageExit()` method, deprecated in Python 3.11. (Contributed by Hugo van Kemenade in [gh-104992](https://github.com/python/cpython/issues/104992).)

  * Remove the `tkinter.tix` module, deprecated in Python 3.6. The third-party Tix library which the module wrapped is unmaintained. (Contributed by Zachary Ware in [gh-75552](https://github.com/python/cpython/issues/75552).)

  * Remove the old trashcan macros `Py_TRASHCAN_SAFE_BEGIN` and `Py_TRASHCAN_SAFE_END`. They should be replaced by the new macros `Py_TRASHCAN_BEGIN` and `Py_TRASHCAN_END`. The new macros were added in Python 3.8 and the old macros were deprecated in Python 3.11. (Contributed by Irit Katriel in [gh-105111](https://github.com/python/cpython/issues/105111).)

  * Remove `locale.resetlocale()` function deprecated in Python 3.11: use `locale.setlocale(locale.LC_ALL, "")` instead. (Contributed by Victor Stinner in [gh-104783](https://github.com/python/cpython/issues/104783).)

  * [`logging`](../library/logging.md#module-logging "logging: Flexible event logging system for applications."): Remove undocumented and untested `Logger.warn()` and `LoggerAdapter.warn()` methods and `logging.warn()` function. Deprecated since Python 3.3, they were aliases to the [`logging.Logger.warning()`](../library/logging.md#logging.Logger.warning "logging.Logger.warning") method, `logging.LoggerAdapter.warning()` method and [`logging.warning()`](../library/logging.md#logging.warning "logging.warning") function. (Contributed by Victor Stinner in [gh-105376](https://github.com/python/cpython/issues/105376).)

  * Remove _cafile_ , _capath_ and _cadefault_ parameters of the [`urllib.request.urlopen()`](../library/urllib.request.md#urllib.request.urlopen "urllib.request.urlopen") function, deprecated in Python 3.6: use the _context_ parameter instead. Please use [`ssl.SSLContext.load_cert_chain()`](../library/ssl.md#ssl.SSLContext.load_cert_chain "ssl.SSLContext.load_cert_chain") instead, or let [`ssl.create_default_context()`](../library/ssl.md#ssl.create_default_context "ssl.create_default_context") select the system's trusted CA certificates for you. (Contributed by Victor Stinner in [gh-105382](https://github.com/python/cpython/issues/105382).)

  * Remove deprecated `webbrowser.MacOSXOSAScript._name` attribute. Use [`webbrowser.MacOSXOSAScript.name`](../library/webbrowser.md#webbrowser.controller.name "webbrowser.controller.name") attribute instead. (Contributed by Nikita Sobolev in [gh-105546](https://github.com/python/cpython/issues/105546).)

  * Remove undocumented, never working, and deprecated `re.template` function and `re.TEMPLATE` flag (and `re.T` alias). (Contributed by Serhiy Storchaka and Nikita Sobolev in [gh-105687](https://github.com/python/cpython/issues/105687).)

## Porting to Python 3.13¶

This section lists previously described changes and other bugfixes that may require changes to your code.

  * The old trashcan macros `Py_TRASHCAN_SAFE_BEGIN` and `Py_TRASHCAN_SAFE_END` were removed. They should be replaced by the new macros `Py_TRASHCAN_BEGIN` and `Py_TRASHCAN_END`.

A tp_dealloc function that has the old macros, such as:

    
        static void
    mytype_dealloc(mytype *p)
    {
        PyObject_GC_UnTrack(p);
        Py_TRASHCAN_SAFE_BEGIN(p);
        ...
        Py_TRASHCAN_SAFE_END
    }
    

should migrate to the new macros as follows:

    
        static void
    mytype_dealloc(mytype *p)
    {
        PyObject_GC_UnTrack(p);
        Py_TRASHCAN_BEGIN(p, mytype_dealloc)
        ...
        Py_TRASHCAN_END
    }
    

Note that `Py_TRASHCAN_BEGIN` has a second argument which should be the deallocation function it is in.

## Build Changes¶

  * Autoconf 2.71 and aclocal 1.16.4 is now required to regenerate the `configure` script. (Contributed by Christian Heimes in [gh-89886](https://github.com/python/cpython/issues/89886).)

  * SQLite 3.15.2 or newer is required to build the [`sqlite3`](../library/sqlite3.md#module-sqlite3 "sqlite3: A DB-API 2.0 implementation using SQLite 3.x.") extension module. (Contributed by Erlend Aasland in [gh-105875](https://github.com/python/cpython/issues/105875).)

  * Python built with `configure` [`--with-trace-refs`](../using/configure.md#cmdoption-with-trace-refs) (tracing references) is now ABI compatible with Python release build and [debug build](../using/configure.md#debug-build). (Contributed by Victor Stinner in [gh-108634](https://github.com/python/cpython/issues/108634).)

  * Building CPython now requires a compiler with support for the C11 atomic library, GCC built-in atomic functions, or MSVC interlocked intrinsics.

## C API Changes¶

### New Features¶

  * You no longer have to define the `PY_SSIZE_T_CLEAN` macro before including `Python.h` when using `#` formats in [format codes](../c-api/arg.md#arg-parsing-string-and-buffers). APIs accepting the format codes always use `Py_ssize_t` for `#` formats. (Contributed by Inada Naoki in [gh-104922](https://github.com/python/cpython/issues/104922).)

  * Add [`PyImport_AddModuleRef()`](../c-api/import.md#c.PyImport_AddModuleRef "PyImport_AddModuleRef"): similar to [`PyImport_AddModule()`](../c-api/import.md#c.PyImport_AddModule "PyImport_AddModule"), but return a [strong reference](../glossary.md#term-strong-reference) instead of a [borrowed reference](../glossary.md#term-borrowed-reference). (Contributed by Victor Stinner in [gh-105922](https://github.com/python/cpython/issues/105922).)

  * Add [`PyWeakref_GetRef()`](../c-api/weakref.md#c.PyWeakref_GetRef "PyWeakref_GetRef") function: similar to [`PyWeakref_GetObject()`](../c-api/weakref.md#c.PyWeakref_GetObject "PyWeakref_GetObject") but returns a [strong reference](../glossary.md#term-strong-reference), or `NULL` if the referent is no longer live. (Contributed by Victor Stinner in [gh-105927](https://github.com/python/cpython/issues/105927).)

  * Add [`PyObject_GetOptionalAttr()`](../c-api/object.md#c.PyObject_GetOptionalAttr "PyObject_GetOptionalAttr") and [`PyObject_GetOptionalAttrString()`](../c-api/object.md#c.PyObject_GetOptionalAttrString "PyObject_GetOptionalAttrString"), variants of [`PyObject_GetAttr()`](../c-api/object.md#c.PyObject_GetAttr "PyObject_GetAttr") and [`PyObject_GetAttrString()`](../c-api/object.md#c.PyObject_GetAttrString "PyObject_GetAttrString") which don't raise [`AttributeError`](../library/exceptions.md#AttributeError "AttributeError") if the attribute is not found. These variants are more convenient and faster if the missing attribute should not be treated as a failure. (Contributed by Serhiy Storchaka in [gh-106521](https://github.com/python/cpython/issues/106521).)

  * Add [`PyMapping_GetOptionalItem()`](../c-api/mapping.md#c.PyMapping_GetOptionalItem "PyMapping_GetOptionalItem") and [`PyMapping_GetOptionalItemString()`](../c-api/mapping.md#c.PyMapping_GetOptionalItemString "PyMapping_GetOptionalItemString"): variants of [`PyObject_GetItem()`](../c-api/object.md#c.PyObject_GetItem "PyObject_GetItem") and [`PyMapping_GetItemString()`](../c-api/mapping.md#c.PyMapping_GetItemString "PyMapping_GetItemString") which don't raise [`KeyError`](../library/exceptions.md#KeyError "KeyError") if the key is not found. These variants are more convenient and faster if the missing key should not be treated as a failure. (Contributed by Serhiy Storchaka in [gh-106307](https://github.com/python/cpython/issues/106307).)

  * If Python is built in [debug mode](../using/configure.md#debug-build) or [`with assertions`](../using/configure.md#cmdoption-with-assertions), [`PyTuple_SET_ITEM()`](../c-api/tuple.md#c.PyTuple_SET_ITEM "PyTuple_SET_ITEM") and [`PyList_SET_ITEM()`](../c-api/list.md#c.PyList_SET_ITEM "PyList_SET_ITEM") now check the index argument with an assertion. If the assertion fails, make sure that the size is set before. (Contributed by Victor Stinner in [gh-106168](https://github.com/python/cpython/issues/106168).)

  * Add [`PyModule_Add()`](../c-api/module.md#c.PyModule_Add "PyModule_Add") function: similar to [`PyModule_AddObjectRef()`](../c-api/module.md#c.PyModule_AddObjectRef "PyModule_AddObjectRef") and [`PyModule_AddObject()`](../c-api/module.md#c.PyModule_AddObject "PyModule_AddObject") but always steals a reference to the value. (Contributed by Serhiy Storchaka in [gh-86493](https://github.com/python/cpython/issues/86493).)

  * Added [`PyDict_GetItemRef()`](../c-api/dict.md#c.PyDict_GetItemRef "PyDict_GetItemRef") and [`PyDict_GetItemStringRef()`](../c-api/dict.md#c.PyDict_GetItemStringRef "PyDict_GetItemStringRef") functions: similar to [`PyDict_GetItemWithError()`](../c-api/dict.md#c.PyDict_GetItemWithError "PyDict_GetItemWithError") but returning a [strong reference](../glossary.md#term-strong-reference) instead of a [borrowed reference](../glossary.md#term-borrowed-reference). Moreover, these functions return -1 on error and so checking `PyErr_Occurred()` is not needed. (Contributed by Victor Stinner in [gh-106004](https://github.com/python/cpython/issues/106004).)

  * Added [`PyDict_ContainsString()`](../c-api/dict.md#c.PyDict_ContainsString "PyDict_ContainsString") function: same as [`PyDict_Contains()`](../c-api/dict.md#c.PyDict_Contains "PyDict_Contains"), but _key_ is specified as a const char* UTF-8 encoded bytes string, rather than a [PyObject](../c-api/structures.md#c.PyObject "PyObject")*. (Contributed by Victor Stinner in [gh-108314](https://github.com/python/cpython/issues/108314).)

  * Add [`Py_IsFinalizing()`](../c-api/init.md#c.Py_IsFinalizing "Py_IsFinalizing") function: check if the main Python interpreter is [shutting down](../glossary.md#term-interpreter-shutdown). (Contributed by Victor Stinner in [gh-108014](https://github.com/python/cpython/issues/108014).)

  * Add [`PyLong_AsInt()`](../c-api/long.md#c.PyLong_AsInt "PyLong_AsInt") function: similar to [`PyLong_AsLong()`](../c-api/long.md#c.PyLong_AsLong "PyLong_AsLong"), but store the result in a C int instead of a C long. Previously, it was known as the private function `_PyLong_AsInt()` (with an underscore prefix). (Contributed by Victor Stinner in [gh-108014](https://github.com/python/cpython/issues/108014).)

  * Python built with `configure` [`--with-trace-refs`](../using/configure.md#cmdoption-with-trace-refs) (tracing references) now supports the [Limited API](../c-api/stable.md#limited-c-api). (Contributed by Victor Stinner in [gh-108634](https://github.com/python/cpython/issues/108634).)

### Porting to Python 3.13¶

  * `Python.h` no longer includes the `<ieeefp.h>` standard header. It was included for the `finite()` function which is now provided by the `<math.h>` header. It should now be included explicitly if needed. Remove also the `HAVE_IEEEFP_H` macro. (Contributed by Victor Stinner in [gh-108765](https://github.com/python/cpython/issues/108765).)

  * `Python.h` no longer includes the `<unistd.h>` standard header file. If needed, it should now be included explicitly. For example, it provides the functions: `close()`, `getpagesize()`, `getpid()` and `sysconf()`. (Contributed by Victor Stinner in [gh-108765](https://github.com/python/cpython/issues/108765).)

  * `Python.h` no longer includes these standard header files: `<time.h>`, `<sys/select.h>` and `<sys/time.h>`. If needed, they should now be included explicitly. For example, `<time.h>` provides the `clock()` and `gmtime()` functions, `<sys/select.h>` provides the `select()` function, and `<sys/time.h>` provides the `futimes()`, `gettimeofday()` and `setitimer()` functions. (Contributed by Victor Stinner in [gh-108765](https://github.com/python/cpython/issues/108765).)

  * `Python.h` no longer includes the `<ctype.h>` standard header file. If needed, it should now be included explicitly. For example, it provides `isalpha()` and `tolower()` functions which are locale dependent. Python provides locale independent functions, like `Py_ISALPHA()` and `Py_TOLOWER()`. (Contributed by Victor Stinner in [gh-108765](https://github.com/python/cpython/issues/108765).)

### Deprecated¶

  * Passing optional arguments _maxsplit_ , _count_ and _flags_ in module-level functions [`re.split()`](../library/re.md#re.split "re.split"), [`re.sub()`](../library/re.md#re.sub "re.sub") and [`re.subn()`](../library/re.md#re.subn "re.subn") as positional arguments is now deprecated. In future Python versions these parameters will be [keyword-only](../glossary.md#keyword-only-parameter). (Contributed by Serhiy Storchaka in [gh-56166](https://github.com/python/cpython/issues/56166).)

  * Deprecate the old `Py_UNICODE` and `PY_UNICODE_TYPE` types: use directly the `wchar_t` type instead. Since Python 3.3, `Py_UNICODE` and `PY_UNICODE_TYPE` are just aliases to `wchar_t`. (Contributed by Victor Stinner in [gh-105156](https://github.com/python/cpython/issues/105156).)

  * Deprecate old Python initialization functions:

    * [`PySys_ResetWarnOptions()`](../c-api/sys.md#c.PySys_ResetWarnOptions "PySys_ResetWarnOptions"): clear [`sys.warnoptions`](../library/sys.md#sys.warnoptions "sys.warnoptions") and `warnings.filters` instead.

    * [`Py_GetExecPrefix()`](../c-api/init.md#c.Py_GetExecPrefix "Py_GetExecPrefix"): get [`sys.exec_prefix`](../library/sys.md#sys.exec_prefix "sys.exec_prefix") instead.

    * [`Py_GetPath()`](../c-api/init.md#c.Py_GetPath "Py_GetPath"): get [`sys.path`](../library/sys.md#sys.path "sys.path") instead.

    * [`Py_GetPrefix()`](../c-api/init.md#c.Py_GetPrefix "Py_GetPrefix"): get [`sys.prefix`](../library/sys.md#sys.prefix "sys.prefix") instead.

    * [`Py_GetProgramFullPath()`](../c-api/init.md#c.Py_GetProgramFullPath "Py_GetProgramFullPath"): get [`sys.executable`](../library/sys.md#sys.executable "sys.executable") instead.

    * [`Py_GetProgramName()`](../c-api/init.md#c.Py_GetProgramName "Py_GetProgramName"): get [`sys.executable`](../library/sys.md#sys.executable "sys.executable") instead.

    * [`Py_GetPythonHome()`](../c-api/init.md#c.Py_GetPythonHome "Py_GetPythonHome"): get [`PyConfig.home`](../c-api/init_config.md#c.PyConfig.home "PyConfig.home") or [`PYTHONHOME`](../using/cmdline.md#envvar-PYTHONHOME) environment variable instead.

Functions scheduled for removal in Python 3.15. (Contributed by Victor Stinner in [gh-105145](https://github.com/python/cpython/issues/105145).)

  * Deprecate the [`PyImport_ImportModuleNoBlock()`](../c-api/import.md#c.PyImport_ImportModuleNoBlock "PyImport_ImportModuleNoBlock") function which is just an alias to [`PyImport_ImportModule()`](../c-api/import.md#c.PyImport_ImportModule "PyImport_ImportModule") since Python 3.3. Scheduled for removal in Python 3.15. (Contributed by Victor Stinner in [gh-105396](https://github.com/python/cpython/issues/105396).)

  * Deprecate the [`PyWeakref_GetObject()`](../c-api/weakref.md#c.PyWeakref_GetObject "PyWeakref_GetObject") and [`PyWeakref_GET_OBJECT()`](../c-api/weakref.md#c.PyWeakref_GET_OBJECT "PyWeakref_GET_OBJECT") functions, which return a [borrowed reference](../glossary.md#term-borrowed-reference): use the new [`PyWeakref_GetRef()`](../c-api/weakref.md#c.PyWeakref_GetRef "PyWeakref_GetRef") function instead, it returns a [strong reference](../glossary.md#term-strong-reference). The [pythoncapi-compat project](https://github.com/python/pythoncapi-compat/) can be used to get [`PyWeakref_GetRef()`](../c-api/weakref.md#c.PyWeakref_GetRef "PyWeakref_GetRef") on Python 3.12 and older. (Contributed by Victor Stinner in [gh-105927](https://github.com/python/cpython/issues/105927).)

### Removed¶

  * Remove many APIs (functions, macros, variables) with names prefixed by `_Py` or `_PY` (considered as private API). If your project is affected by one of these removals and you consider that the removed API should remain available, please open a new issue to request a public C API and add `cc @vstinner` to the issue to notify Victor Stinner. (Contributed by Victor Stinner in [gh-106320](https://github.com/python/cpython/issues/106320).)

  * Remove functions deprecated in Python 3.9.

    * `PyEval_CallObject()`, `PyEval_CallObjectWithKeywords()`: use [`PyObject_CallNoArgs()`](../c-api/call.md#c.PyObject_CallNoArgs "PyObject_CallNoArgs") or [`PyObject_Call()`](../c-api/call.md#c.PyObject_Call "PyObject_Call") instead. Warning: [`PyObject_Call()`](../c-api/call.md#c.PyObject_Call "PyObject_Call") positional arguments must be a [`tuple`](../library/stdtypes.md#tuple "tuple") and must not be _NULL_ , keyword arguments must be a [`dict`](../library/stdtypes.md#dict "dict") or _NULL_ , whereas removed functions checked arguments type and accepted _NULL_ positional and keyword arguments. To replace `PyEval_CallObjectWithKeywords(func, NULL, kwargs)` with [`PyObject_Call()`](../c-api/call.md#c.PyObject_Call "PyObject_Call"), pass an empty tuple as positional arguments using [`PyTuple_New(0)`](../c-api/tuple.md#c.PyTuple_New "PyTuple_New").

    * `PyEval_CallFunction()`: use [`PyObject_CallFunction()`](../c-api/call.md#c.PyObject_CallFunction "PyObject_CallFunction") instead.

    * `PyEval_CallMethod()`: use [`PyObject_CallMethod()`](../c-api/call.md#c.PyObject_CallMethod "PyObject_CallMethod") instead.

    * `PyCFunction_Call()`: use [`PyObject_Call()`](../c-api/call.md#c.PyObject_Call "PyObject_Call") instead.

(Contributed by Victor Stinner in [gh-105107](https://github.com/python/cpython/issues/105107).)

  * Remove old buffer protocols deprecated in Python 3.0. Use [缓冲协议](../c-api/buffer.md#bufferobjects) instead.

>     * `PyObject_CheckReadBuffer()`: Use [`PyObject_CheckBuffer()`](../c-api/buffer.md#c.PyObject_CheckBuffer "PyObject_CheckBuffer") to test if the object supports the buffer protocol. Note that [`PyObject_CheckBuffer()`](../c-api/buffer.md#c.PyObject_CheckBuffer "PyObject_CheckBuffer") doesn't guarantee that [`PyObject_GetBuffer()`](../c-api/buffer.md#c.PyObject_GetBuffer "PyObject_GetBuffer") will succeed. To test if the object is actually readable, see the next example of [`PyObject_GetBuffer()`](../c-api/buffer.md#c.PyObject_GetBuffer "PyObject_GetBuffer").
>
>     * `PyObject_AsCharBuffer()`, `PyObject_AsReadBuffer()`: [`PyObject_GetBuffer()`](../c-api/buffer.md#c.PyObject_GetBuffer "PyObject_GetBuffer") and [`PyBuffer_Release()`](../c-api/buffer.md#c.PyBuffer_Release "PyBuffer_Release") instead:
>  
>         >         Py_buffer view;
>         if (PyObject_GetBuffer(obj, &view, PyBUF_SIMPLE) < 0) {
>             return NULL;
>         }
>         // Use `view.buf` and `view.len` to read from the buffer.
>         // You may need to cast buf as `(const char*)view.buf`.
>         PyBuffer_Release(&view);
>  
>
>     * `PyObject_AsWriteBuffer()`: Use [`PyObject_GetBuffer()`](../c-api/buffer.md#c.PyObject_GetBuffer "PyObject_GetBuffer") and [`PyBuffer_Release()`](../c-api/buffer.md#c.PyBuffer_Release "PyBuffer_Release") instead:
>  
>         >         Py_buffer view;
>         if (PyObject_GetBuffer(obj, &view, PyBUF_WRITABLE) < 0) {
>             return NULL;
>         }
>         // Use `view.buf` and `view.len` to write to the buffer.
>         PyBuffer_Release(&view);
>  

(Contributed by Inada Naoki in [gh-85275](https://github.com/python/cpython/issues/85275).)

  * Remove the following old functions to configure the Python initialization, deprecated in Python 3.11:

    * `PySys_AddWarnOptionUnicode()`: use [`PyConfig.warnoptions`](../c-api/init_config.md#c.PyConfig.warnoptions "PyConfig.warnoptions") instead.

    * `PySys_AddWarnOption()`: use [`PyConfig.warnoptions`](../c-api/init_config.md#c.PyConfig.warnoptions "PyConfig.warnoptions") instead.

    * `PySys_AddXOption()`: use [`PyConfig.xoptions`](../c-api/init_config.md#c.PyConfig.xoptions "PyConfig.xoptions") instead.

    * `PySys_HasWarnOptions()`: use [`PyConfig.xoptions`](../c-api/init_config.md#c.PyConfig.xoptions "PyConfig.xoptions") instead.

    * `PySys_SetArgvEx()`: set [`PyConfig.argv`](../c-api/init_config.md#c.PyConfig.argv "PyConfig.argv") instead.

    * `PySys_SetArgv()`: set [`PyConfig.argv`](../c-api/init_config.md#c.PyConfig.argv "PyConfig.argv") instead.

    * `PySys_SetPath()`: set [`PyConfig.module_search_paths`](../c-api/init_config.md#c.PyConfig.module_search_paths "PyConfig.module_search_paths") instead.

    * `Py_SetPath()`: set [`PyConfig.module_search_paths`](../c-api/init_config.md#c.PyConfig.module_search_paths "PyConfig.module_search_paths") instead.

    * `Py_SetProgramName()`: set [`PyConfig.program_name`](../c-api/init_config.md#c.PyConfig.program_name "PyConfig.program_name") instead.

    * `Py_SetPythonHome()`: set [`PyConfig.home`](../c-api/init_config.md#c.PyConfig.home "PyConfig.home") instead.

    * `Py_SetStandardStreamEncoding()`: set [`PyConfig.stdio_encoding`](../c-api/init_config.md#c.PyConfig.stdio_encoding "PyConfig.stdio_encoding") instead, and set also maybe [`PyConfig.legacy_windows_stdio`](../c-api/init_config.md#c.PyConfig.legacy_windows_stdio "PyConfig.legacy_windows_stdio") (on Windows).

    * `_Py_SetProgramFullPath()`: set [`PyConfig.executable`](../c-api/init_config.md#c.PyConfig.executable "PyConfig.executable") instead.

Use the new [`PyConfig`](../c-api/init_config.md#c.PyConfig "PyConfig") API of the [Python Initialization Configuration](../c-api/init_config.md#init-config) instead ([ **PEP 587**](https://peps.python.org/pep-0587/)), added to Python 3.8. (Contributed by Victor Stinner in [gh-105145](https://github.com/python/cpython/issues/105145).)

  * Remove `PyEval_InitThreads()` and `PyEval_ThreadsInitialized()` functions, deprecated in Python 3.9. Since Python 3.7, `Py_Initialize()` always creates the GIL: calling `PyEval_InitThreads()` did nothing and `PyEval_ThreadsInitialized()` always returned non-zero. (Contributed by Victor Stinner in [gh-105182](https://github.com/python/cpython/issues/105182).)

  * Remove `PyEval_AcquireLock()` and `PyEval_ReleaseLock()` functions, deprecated in Python 3.2. They didn't update the current thread state. They can be replaced with:

    * [`PyEval_SaveThread()`](../c-api/init.md#c.PyEval_SaveThread "PyEval_SaveThread") and [`PyEval_RestoreThread()`](../c-api/init.md#c.PyEval_RestoreThread "PyEval_RestoreThread");

    * low-level [`PyEval_AcquireThread()`](../c-api/init.md#c.PyEval_AcquireThread "PyEval_AcquireThread") and [`PyEval_RestoreThread()`](../c-api/init.md#c.PyEval_RestoreThread "PyEval_RestoreThread");

    * or [`PyGILState_Ensure()`](../c-api/init.md#c.PyGILState_Ensure "PyGILState_Ensure") and [`PyGILState_Release()`](../c-api/init.md#c.PyGILState_Release "PyGILState_Release").

(Contributed by Victor Stinner in [gh-105182](https://github.com/python/cpython/issues/105182).)

  * Remove the old aliases to functions calling functions which were kept for backward compatibility with Python 3.8 provisional API:

    * `_PyObject_CallMethodNoArgs()`: use `PyObject_CallMethodNoArgs()`

    * `_PyObject_CallMethodOneArg()`: use `PyObject_CallMethodOneArg()`

    * `_PyObject_CallOneArg()`: use `PyObject_CallOneArg()`

    * `_PyObject_FastCallDict()`: use `PyObject_VectorcallDict()`

    * `_PyObject_Vectorcall()`: use `PyObject_Vectorcall()`

    * `_PyObject_VectorcallMethod()`: use `PyObject_VectorcallMethod()`

    * `_PyVectorcall_Function()`: use `PyVectorcall_Function()`

Just remove the underscore prefix to update your code. (Contributed by Victor Stinner in [gh-106084](https://github.com/python/cpython/issues/106084).)

  * Remove private `_PyObject_FastCall()` function: use `PyObject_Vectorcall()` which is available since Python 3.8 ([ **PEP 590**](https://peps.python.org/pep-0590/)). (Contributed by Victor Stinner in [gh-106023](https://github.com/python/cpython/issues/106023).)

  * Remove `cpython/pytime.h` header file: it only contained private functions. (Contributed by Victor Stinner in [gh-106316](https://github.com/python/cpython/issues/106316).)

  * Remove `_PyInterpreterState_Get()` alias to [`PyInterpreterState_Get()`](../c-api/init.md#c.PyInterpreterState_Get "PyInterpreterState_Get") which was kept for backward compatibility with Python 3.8. The [pythoncapi-compat project](https://github.com/python/pythoncapi-compat/) can be used to get [`PyInterpreterState_Get()`](../c-api/init.md#c.PyInterpreterState_Get "PyInterpreterState_Get") on Python 3.8 and older. (Contributed by Victor Stinner in [gh-106320](https://github.com/python/cpython/issues/106320).)

  * The [`PyModule_AddObject()`](../c-api/module.md#c.PyModule_AddObject "PyModule_AddObject") function is now [soft deprecated](../glossary.md#term-soft-deprecated): [`PyModule_Add()`](../c-api/module.md#c.PyModule_Add "PyModule_Add") or [`PyModule_AddObjectRef()`](../c-api/module.md#c.PyModule_AddObjectRef "PyModule_AddObjectRef") functions should be used instead. (Contributed by Serhiy Storchaka in [gh-86493](https://github.com/python/cpython/issues/86493).)

### Pending Removal in Python 3.14¶

  * Creating immutable types ([`Py_TPFLAGS_IMMUTABLETYPE`](../c-api/typeobj.md#c.Py_TPFLAGS_IMMUTABLETYPE "Py_TPFLAGS_IMMUTABLETYPE")) with mutable bases using the C API.

  * Global configuration variables:

    * [`Py_DebugFlag`](../c-api/init.md#c.Py_DebugFlag "Py_DebugFlag"): use [`PyConfig.parser_debug`](../c-api/init_config.md#c.PyConfig.parser_debug "PyConfig.parser_debug")

    * [`Py_VerboseFlag`](../c-api/init.md#c.Py_VerboseFlag "Py_VerboseFlag"): use [`PyConfig.verbose`](../c-api/init_config.md#c.PyConfig.verbose "PyConfig.verbose")

    * [`Py_QuietFlag`](../c-api/init.md#c.Py_QuietFlag "Py_QuietFlag"): use [`PyConfig.quiet`](../c-api/init_config.md#c.PyConfig.quiet "PyConfig.quiet")

    * [`Py_InteractiveFlag`](../c-api/init.md#c.Py_InteractiveFlag "Py_InteractiveFlag"): use [`PyConfig.interactive`](../c-api/init_config.md#c.PyConfig.interactive "PyConfig.interactive")

    * [`Py_InspectFlag`](../c-api/init.md#c.Py_InspectFlag "Py_InspectFlag"): use [`PyConfig.inspect`](../c-api/init_config.md#c.PyConfig.inspect "PyConfig.inspect")

    * [`Py_OptimizeFlag`](../c-api/init.md#c.Py_OptimizeFlag "Py_OptimizeFlag"): use [`PyConfig.optimization_level`](../c-api/init_config.md#c.PyConfig.optimization_level "PyConfig.optimization_level")

    * [`Py_NoSiteFlag`](../c-api/init.md#c.Py_NoSiteFlag "Py_NoSiteFlag"): use [`PyConfig.site_import`](../c-api/init_config.md#c.PyConfig.site_import "PyConfig.site_import")

    * [`Py_BytesWarningFlag`](../c-api/init.md#c.Py_BytesWarningFlag "Py_BytesWarningFlag"): use [`PyConfig.bytes_warning`](../c-api/init_config.md#c.PyConfig.bytes_warning "PyConfig.bytes_warning")

    * [`Py_FrozenFlag`](../c-api/init.md#c.Py_FrozenFlag "Py_FrozenFlag"): use [`PyConfig.pathconfig_warnings`](../c-api/init_config.md#c.PyConfig.pathconfig_warnings "PyConfig.pathconfig_warnings")

    * [`Py_IgnoreEnvironmentFlag`](../c-api/init.md#c.Py_IgnoreEnvironmentFlag "Py_IgnoreEnvironmentFlag"): use [`PyConfig.use_environment`](../c-api/init_config.md#c.PyConfig.use_environment "PyConfig.use_environment")

    * [`Py_DontWriteBytecodeFlag`](../c-api/init.md#c.Py_DontWriteBytecodeFlag "Py_DontWriteBytecodeFlag"): use [`PyConfig.write_bytecode`](../c-api/init_config.md#c.PyConfig.write_bytecode "PyConfig.write_bytecode")

    * [`Py_NoUserSiteDirectory`](../c-api/init.md#c.Py_NoUserSiteDirectory "Py_NoUserSiteDirectory"): use [`PyConfig.user_site_directory`](../c-api/init_config.md#c.PyConfig.user_site_directory "PyConfig.user_site_directory")

    * [`Py_UnbufferedStdioFlag`](../c-api/init.md#c.Py_UnbufferedStdioFlag "Py_UnbufferedStdioFlag"): use [`PyConfig.buffered_stdio`](../c-api/init_config.md#c.PyConfig.buffered_stdio "PyConfig.buffered_stdio")

    * [`Py_HashRandomizationFlag`](../c-api/init.md#c.Py_HashRandomizationFlag "Py_HashRandomizationFlag"): use [`PyConfig.use_hash_seed`](../c-api/init_config.md#c.PyConfig.use_hash_seed "PyConfig.use_hash_seed") and [`PyConfig.hash_seed`](../c-api/init_config.md#c.PyConfig.hash_seed "PyConfig.hash_seed")

    * [`Py_IsolatedFlag`](../c-api/init.md#c.Py_IsolatedFlag "Py_IsolatedFlag"): use [`PyConfig.isolated`](../c-api/init_config.md#c.PyConfig.isolated "PyConfig.isolated")

    * [`Py_LegacyWindowsFSEncodingFlag`](../c-api/init.md#c.Py_LegacyWindowsFSEncodingFlag "Py_LegacyWindowsFSEncodingFlag"): use [`PyPreConfig.legacy_windows_fs_encoding`](../c-api/init_config.md#c.PyPreConfig.legacy_windows_fs_encoding "PyPreConfig.legacy_windows_fs_encoding")

    * [`Py_LegacyWindowsStdioFlag`](../c-api/init.md#c.Py_LegacyWindowsStdioFlag "Py_LegacyWindowsStdioFlag"): use [`PyConfig.legacy_windows_stdio`](../c-api/init_config.md#c.PyConfig.legacy_windows_stdio "PyConfig.legacy_windows_stdio")

    * `Py_FileSystemDefaultEncoding`: use [`PyConfig.filesystem_encoding`](../c-api/init_config.md#c.PyConfig.filesystem_encoding "PyConfig.filesystem_encoding")

    * `Py_HasFileSystemDefaultEncoding`: use [`PyConfig.filesystem_encoding`](../c-api/init_config.md#c.PyConfig.filesystem_encoding "PyConfig.filesystem_encoding")

    * `Py_FileSystemDefaultEncodeErrors`: use [`PyConfig.filesystem_errors`](../c-api/init_config.md#c.PyConfig.filesystem_errors "PyConfig.filesystem_errors")

    * `Py_UTF8Mode`: use [`PyPreConfig.utf8_mode`](../c-api/init_config.md#c.PyPreConfig.utf8_mode "PyPreConfig.utf8_mode") (see [`Py_PreInitialize()`](../c-api/init_config.md#c.Py_PreInitialize "Py_PreInitialize"))

The [`Py_InitializeFromConfig()`](../c-api/init_config.md#c.Py_InitializeFromConfig "Py_InitializeFromConfig") API should be used with [`PyConfig`](../c-api/init_config.md#c.PyConfig "PyConfig") instead.

### Pending Removal in Python 3.15¶

  * [`PyImport_ImportModuleNoBlock()`](../c-api/import.md#c.PyImport_ImportModuleNoBlock "PyImport_ImportModuleNoBlock"): use [`PyImport_ImportModule()`](../c-api/import.md#c.PyImport_ImportModule "PyImport_ImportModule").

  * [`PyWeakref_GET_OBJECT()`](../c-api/weakref.md#c.PyWeakref_GET_OBJECT "PyWeakref_GET_OBJECT"): use [`PyWeakref_GetRef()`](../c-api/weakref.md#c.PyWeakref_GetRef "PyWeakref_GetRef") instead.

  * [`PyWeakref_GetObject()`](../c-api/weakref.md#c.PyWeakref_GetObject "PyWeakref_GetObject"): use [`PyWeakref_GetRef()`](../c-api/weakref.md#c.PyWeakref_GetRef "PyWeakref_GetRef") instead.

  * `Py_UNICODE_WIDE` type: use `wchar_t` instead.

  * [`Py_UNICODE`](../c-api/unicode.md#c.Py_UNICODE "Py_UNICODE") type: use `wchar_t` instead.

  * Python initialization functions:

    * [`PySys_ResetWarnOptions()`](../c-api/sys.md#c.PySys_ResetWarnOptions "PySys_ResetWarnOptions"): clear [`sys.warnoptions`](../library/sys.md#sys.warnoptions "sys.warnoptions") and `warnings.filters` instead.

    * [`Py_GetExecPrefix()`](../c-api/init.md#c.Py_GetExecPrefix "Py_GetExecPrefix"): get [`sys.exec_prefix`](../library/sys.md#sys.exec_prefix "sys.exec_prefix") instead.

    * [`Py_GetPath()`](../c-api/init.md#c.Py_GetPath "Py_GetPath"): get [`sys.path`](../library/sys.md#sys.path "sys.path") instead.

    * [`Py_GetPrefix()`](../c-api/init.md#c.Py_GetPrefix "Py_GetPrefix"): get [`sys.prefix`](../library/sys.md#sys.prefix "sys.prefix") instead.

    * [`Py_GetProgramFullPath()`](../c-api/init.md#c.Py_GetProgramFullPath "Py_GetProgramFullPath"): get [`sys.executable`](../library/sys.md#sys.executable "sys.executable") instead.

    * [`Py_GetProgramName()`](../c-api/init.md#c.Py_GetProgramName "Py_GetProgramName"): get [`sys.executable`](../library/sys.md#sys.executable "sys.executable") instead.

    * [`Py_GetPythonHome()`](../c-api/init.md#c.Py_GetPythonHome "Py_GetPythonHome"): get [`PyConfig.home`](../c-api/init_config.md#c.PyConfig.home "PyConfig.home") or [`PYTHONHOME`](../using/cmdline.md#envvar-PYTHONHOME) environment variable instead.

### Pending Removal in Future Versions¶

The following APIs were deprecated in earlier Python versions and will be removed, although there is currently no date scheduled for their removal.

  * [`Py_TPFLAGS_HAVE_FINALIZE`](../c-api/typeobj.md#c.Py_TPFLAGS_HAVE_FINALIZE "Py_TPFLAGS_HAVE_FINALIZE"): no needed since Python 3.8.

  * [`PyErr_Fetch()`](../c-api/exceptions.md#c.PyErr_Fetch "PyErr_Fetch"): use [`PyErr_GetRaisedException()`](../c-api/exceptions.md#c.PyErr_GetRaisedException "PyErr_GetRaisedException").

  * [`PyErr_NormalizeException()`](../c-api/exceptions.md#c.PyErr_NormalizeException "PyErr_NormalizeException"): use [`PyErr_GetRaisedException()`](../c-api/exceptions.md#c.PyErr_GetRaisedException "PyErr_GetRaisedException").

  * [`PyErr_Restore()`](../c-api/exceptions.md#c.PyErr_Restore "PyErr_Restore"): use [`PyErr_SetRaisedException()`](../c-api/exceptions.md#c.PyErr_SetRaisedException "PyErr_SetRaisedException").

  * [`PyModule_GetFilename()`](../c-api/module.md#c.PyModule_GetFilename "PyModule_GetFilename"): use [`PyModule_GetFilenameObject()`](../c-api/module.md#c.PyModule_GetFilenameObject "PyModule_GetFilenameObject").

  * [`PyOS_AfterFork()`](../c-api/sys.md#c.PyOS_AfterFork "PyOS_AfterFork"): use [`PyOS_AfterFork_Child()`](../c-api/sys.md#c.PyOS_AfterFork_Child "PyOS_AfterFork_Child").

  * [`PySlice_GetIndicesEx()`](../c-api/slice.md#c.PySlice_GetIndicesEx "PySlice_GetIndicesEx").

  * `PyUnicode_AsDecodedObject()`.

  * `PyUnicode_AsDecodedUnicode()`.

  * `PyUnicode_AsEncodedObject()`.

  * `PyUnicode_AsEncodedUnicode()`.

  * [`PyUnicode_READY()`](../c-api/unicode.md#c.PyUnicode_READY "PyUnicode_READY"): not needed since Python 3.12.

  * `_PyErr_ChainExceptions()`.

  * `PyBytesObject.ob_shash` member: call [`PyObject_Hash()`](../c-api/object.md#c.PyObject_Hash "PyObject_Hash") instead.

  * `PyDictObject.ma_version_tag` member.

  * TLS API:

    * [`PyThread_create_key()`](../c-api/init.md#c.PyThread_create_key "PyThread_create_key"): use [`PyThread_tss_alloc()`](../c-api/init.md#c.PyThread_tss_alloc "PyThread_tss_alloc").

    * [`PyThread_delete_key()`](../c-api/init.md#c.PyThread_delete_key "PyThread_delete_key"): use [`PyThread_tss_free()`](../c-api/init.md#c.PyThread_tss_free "PyThread_tss_free").

    * [`PyThread_set_key_value()`](../c-api/init.md#c.PyThread_set_key_value "PyThread_set_key_value"): use [`PyThread_tss_set()`](../c-api/init.md#c.PyThread_tss_set "PyThread_tss_set").

    * [`PyThread_get_key_value()`](../c-api/init.md#c.PyThread_get_key_value "PyThread_get_key_value"): use [`PyThread_tss_get()`](../c-api/init.md#c.PyThread_tss_get "PyThread_tss_get").

    * [`PyThread_delete_key_value()`](../c-api/init.md#c.PyThread_delete_key_value "PyThread_delete_key_value"): use [`PyThread_tss_delete()`](../c-api/init.md#c.PyThread_tss_delete "PyThread_tss_delete").

    * [`PyThread_ReInitTLS()`](../c-api/init.md#c.PyThread_ReInitTLS "PyThread_ReInitTLS"): no longer needed.

